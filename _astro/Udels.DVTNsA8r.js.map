{"version":3,"file":"Udels.DVTNsA8r.js","sources":["../../src/components/Udels/UdelFrame.jsx","../../src/repl/components/NumberInput.jsx","../../src/components/Udels/UdelsHeader.jsx","../../src/components/Udels/Udels.jsx"],"sourcesContent":["import { useRef } from 'react';\n\nexport function UdelFrame({ onEvaluate, hash, instance }) {\n  const ref = useRef();\n  window.addEventListener('message', (message) => {\n    const childWindow = ref?.current?.contentWindow;\n    if (message == null || message.source !== childWindow) {\n      return; // Skip message in this event listener\n    }\n    onEvaluate(message.data);\n  });\n\n  const url = new URL(window.location.origin);\n  url.hash = hash;\n  url.searchParams.append('instance', instance);\n  const source = url.toString();\n\n  return (\n    <iframe\n      ref={ref}\n      style={{\n        display: 'flex',\n        flexGrow: 1,\n        minWidth: '50%',\n        boxSizing: 'border-box',\n        border: '0px',\n      }}\n      title=\"strudel embed\"\n      src={source}\n    ></iframe>\n  );\n}\n","function Button(Props) {\n  const { children, onClick } = Props;\n\n  return (\n    <button\n      onClick={onClick}\n      type=\"button\"\n      data-input-counter-increment=\"counter-input\"\n      className=\"flex-shrink-0  bg-gray-700 hover:bg-gray-600 border-gray-600 inline-flex items-center justify-center border rounded-md h-5 w-5  focus:ring-gray-700 focus:ring-2 focus:outline-none\"\n    >\n      {children}\n    </button>\n  );\n}\nexport default function NumberInput(Props) {\n  const { value = 0, setValue, max, min } = Props;\n\n  return (\n    <div className=\"relative flex items-center\">\n      <Button onClick={() => setValue(value - 1)}>\n        <svg\n          className=\"w-2.5 h-2.5 text-white\"\n          aria-hidden=\"true\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          fill=\"none\"\n          viewBox=\"0 0 18 2\"\n        >\n          <path stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M1 1h16\" />\n        </svg>\n      </Button>\n      <input\n        min={min}\n        max={max}\n        type=\"text\"\n        data-input-counter\n        className=\"flex-shrink-0 text-white border-0 bg-transparent text-sm font-normal focus:outline-none focus:ring-0 max-w-[2.5rem] text-center\"\n        placeholder=\"\"\n        value={value}\n        onChange={(e) => setValue(e.target.value)}\n      />\n      <Button onClick={() => setValue(value + 1)}>\n        <svg\n          className=\"w-2.5 h-2.5 text-white\"\n          aria-hidden=\"true\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          fill=\"none\"\n          viewBox=\"0 0 18 18\"\n        >\n          <path strokeLinecap=\"round\" stroke=\"currentColor\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M9 1v16M1 9h16\" />\n        </svg>\n      </Button>\n    </div>\n  );\n}\n","import NumberInput from '@src/repl/components/NumberInput';\n\nexport default function UdelsHeader(Props) {\n  const { numWindows, setNumWindows } = Props;\n\n  return (\n    <header id=\"header\" className=\"flex text-white  z-[100] text-lg select-none bg-neutral-900\">\n      <div className=\"px-4 items-center gap-2  flex space-x-2 md:pt-0 select-none\">\n        <h1 onClick={() => {}} className={'text-l cursor-pointer flex gap-4'}>\n          <div className={'mt-[1px] cursor-pointer'}>ðŸŒ€</div>\n\n          <div className={'animate-pulse'}>\n            <span className=\"\">strudel</span> <span className=\"text-sm\">-UDELS</span>\n          </div>\n        </h1>\n        <NumberInput value={numWindows} setValue={setNumWindows} />\n      </div>\n    </header>\n  );\n}\n","import { code2hash } from '@strudel/core';\n\nimport { UdelFrame } from './UdelFrame';\nimport { useState } from 'react';\nimport UdelsHeader from './UdelsHeader';\n\nconst defaultHash = 'c3RhY2soCiAgCik%3D';\n\nconst getHashesFromUrl = () => {\n  return window.location.hash?.slice(1).split(',');\n};\nconst updateURLHashes = (hashes) => {\n  const newHash = '#' + hashes.join(',');\n  window.location.hash = newHash;\n};\nexport function Udels() {\n  const hashes = getHashesFromUrl();\n\n  const [numWindows, setNumWindows] = useState(hashes?.length ?? 1);\n  const numWindowsOnChange = (num) => {\n    setNumWindows(num);\n    const hashes = getHashesFromUrl();\n    const newHashes = [];\n    for (let i = 0; i < num; i++) {\n      newHashes[i] = hashes[i] ?? defaultHash;\n    }\n    updateURLHashes(newHashes);\n  };\n\n  const onEvaluate = (key, code) => {\n    const hashes = getHashesFromUrl();\n    hashes[key] = code2hash(code);\n\n    updateURLHashes(hashes);\n  };\n\n  return (\n    <div\n      style={{\n        margin: 0,\n        display: 'flex',\n        flex: 1,\n        height: '100vh',\n        width: '100%',\n        flexDirection: 'column',\n      }}\n    >\n      <UdelsHeader numWindows={numWindows} setNumWindows={numWindowsOnChange} />\n      <div\n        style={{\n          display: 'flex',\n          flex: 1,\n          flexDirection: 'row',\n          flexWrap: 'wrap',\n        }}\n      >\n        {hashes.map((hash, key) => {\n          return (\n            <UdelFrame\n              instance={key}\n              onEvaluate={(code) => {\n                onEvaluate(key, code);\n              }}\n              hash={hash}\n              key={key}\n            />\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n"],"names":["UdelFrame","onEvaluate","hash","instance","ref","useRef","message","childWindow","url","source","jsx","Button","Props","children","onClick","NumberInput","value","setValue","max","min","jsxs","e","UdelsHeader","numWindows","setNumWindows","defaultHash","getHashesFromUrl","updateURLHashes","hashes","newHash","Udels","useState","numWindowsOnChange","num","newHashes","i","key","code","code2hash"],"mappings":"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"}