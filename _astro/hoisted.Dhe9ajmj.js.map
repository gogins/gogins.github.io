{"version":3,"mappings":";;;;;;0JAkDEA,EAAUC,EAAmB,MAAM,KAAK,EAGxC,MAAMC,EAAY,IAAM,CACV,SAAS,gBACjB,MAAM,YAAY,eAAgB,GAAG,OAAO,YAAc,CAAC,IAAI,CACrE,EACI,OAAO,OAAW,MACb,wBAAiB,SAAUA,CAAS,EACjCA,KCtDd,SAASC,EAAWC,EAAU,GAAI,CAChC,KAAM,CACJ,UAAAC,EAAY,GACZ,cAAAC,EACA,eAAAC,EACA,aAAAC,EACA,eAAAC,EACA,gBAAAC,CACD,EAAGN,EACJ,IAAIO,EACAC,EAEJ,MAAMC,EAAsB,MAAOC,EAAc,KAAS,CACxD,MAAMF,CAIV,EACE,eAAeG,GAAW,CACxB,GAAI,kBAAmB,UAAW,CAChC,KAAM,CAAE,QAAAC,CAAO,EAAK,MAAKC,EAAA,IAAC,OAAO,uCAAgB,uBACjDN,EAAK,IAAIK,EAAQ,SAAU,CAAE,MAAO,IAAK,KAAM,SAAS,CAAE,EAMtDL,EAAG,iBAAiB,YAAcO,GAAU,EACtCA,EAAM,UAAYA,EAAM,aAC1B,OAAO,SAAS,QAC9B,CAAW,EACDP,EAAG,iBAAiB,YAAcO,GAAU,CACrCA,EAAM,UACTX,KAEd,CAAW,EAgCLI,EAAG,SAAS,CAAE,UAAAN,CAAW,GAAE,KAAMc,GAAM,CACjCV,EACFA,EAAe,SAAUU,CAAC,EAE1BX,IAAeW,CAAC,CAC1B,CAAO,EAAE,MAAO,GAAM,CACdT,IAAkB,CAAC,CAC3B,CAAO,CACF,CACF,CACD,OAAAE,EAAkBG,EAAQ,EACnBF,CACT,CClFAV,EAAW,CACT,UAAW,GACX,eAAeiB,EAAa,CAE5B,EACA,gBAAiB,CAEjB,CACF,CAAC","names":["initTheme","codemirrorSettings","appHeight","registerSW","options","immediate","onNeedRefresh","onOfflineReady","onRegistered","onRegisteredSW","onRegisterError","wb","registerPromise","updateServiceWorker","_reloadPage","register","Workbox","__vitePreload","event","r","swScriptUrl"],"ignoreList":[],"sources":["../../src/components/HeadCommon.astro?astro&type=script&index=0&lang.ts","../../../../../../../@vite-plugin-pwa/virtual:pwa-register","../../src/pwa.ts"],"sourcesContent":["  import { initTheme, codemirrorSettings } from '@strudel/codemirror';\n\n  initTheme(codemirrorSettings.get().theme);\n\n  // https://medium.com/quick-code/100vh-problem-with-ios-safari-92ab23c852a8\n  const appHeight = () => {\n    const doc = document.documentElement;\n    doc.style.setProperty('--app-height', `${window.innerHeight - 1}px`);\n  };\n  if (typeof window !== 'undefined') {\n    window.addEventListener('resize', appHeight);\n    appHeight();\n  }\n\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyAidmVyc2lvbiI6IDMsICJzb3VyY2VzIjogWyIvVXNlcnMvbWljaGFlbGdvZ2lucy9jbG91ZC01L3N0cnVkZWwvd2Vic2l0ZS9zcmMvY29tcG9uZW50cy9IZWFkQ29tbW9uLmFzdHJvIl0sICJzb3VyY2VzQ29udGVudCI6IFsiLS0tXG5pbXBvcnQgeyBwd2FJbmZvIH0gZnJvbSAndmlydHVhbDpwd2EtaW5mbyc7XG5pbXBvcnQgJy4uL3N0eWxlcy9pbmRleC5jc3MnO1xuXG5jb25zdCB7IEJBU0VfVVJMIH0gPSBpbXBvcnQubWV0YS5lbnY7XG5jb25zdCBiYXNlTm9UcmFpbGluZyA9IEJBU0VfVVJMLmVuZHNXaXRoKCcvJykgPyBCQVNFX1VSTC5zbGljZSgwLCAtMSkgOiBCQVNFX1VSTDtcbi0tLVxuXG5cdTAwM2MhLS0gR2xvYmFsIE1ldGFkYXRhIC0tXHUwMDNlXG5cdTAwM2NtZXRhIGNoYXJzZXQ9XCJ1dGYtOFwiIC9cdTAwM2Vcblx1MDAzY21ldGEgbmFtZT1cInZpZXdwb3J0XCIgY29udGVudD1cIndpZHRoPWRldmljZS13aWR0aFwiIC9cdTAwM2Vcblx1MDAzY21ldGEgbmFtZT1cImdlbmVyYXRvclwiIGNvbnRlbnQ9e0FzdHJvLmdlbmVyYXRvcn0gL1x1MDAzZVxuXHUwMDNjbGluayByZWw9XCJhbHRlcm5hdGVcIiB0eXBlPVwiYXBwbGljYXRpb24vcnNzK3htbFwiIHRpdGxlPXtgUlNTIEZlZWQgZm9yIHN0cnVkZWwuY2NgfSBocmVmPVwiL3Jzcy54bWxcIiAvXHUwMDNlXG5cdTAwM2NsaW5rIHJlbD1cImljb25cIiB0eXBlPVwiaW1hZ2Uvc3ZnK3htbFwiIGhyZWY9e2Ake2Jhc2VOb1RyYWlsaW5nfS9mYXZpY29uLmljb2B9IC9cdTAwM2VcblxuXHUwMDNjbWV0YVxuICBuYW1lPVwiZGVzY3JpcHRpb25cIlxuICBjb250ZW50PVwiU3RydWRlbCBpcyBhIG11c2ljIGxpdmUgY29kaW5nIGVudmlyb25tZW50IGZvciB0aGUgYnJvd3NlciwgcG9ydGluZyB0aGUgVGlkYWxDeWNsZXMgcGF0dGVybiBsYW5ndWFnZSB0byBKYXZhU2NyaXB0LlwiXG4vXHUwMDNlXG5cdTAwM2NsaW5rIHJlbD1cImljb25cIiBocmVmPXtgJHtiYXNlTm9UcmFpbGluZ30vZmF2aWNvbi5pY29gfSAvXHUwMDNlXG5cdTAwM2NsaW5rIHJlbD1cImFwcGxlLXRvdWNoLWljb25cIiBocmVmPXtgJHtiYXNlTm9UcmFpbGluZ30vaWNvbnMvYXBwbGUtaWNvbi0xODAucG5nYH0gc2l6ZXM9XCIxODB4MTgwXCIgL1x1MDAzZVxuXHUwMDNjbWV0YSBuYW1lPVwidGhlbWUtY29sb3JcIiBjb250ZW50PVwiIzIyMjIyMlwiIC9cdTAwM2VcblxuXHUwMDNjYmFzZSBocmVmPXtCQVNFX1VSTH0gL1x1MDAzZVxuXG5cdTAwM2MhLS0gU2Nyb2xsYWJsZSBhMTF5IGNvZGUgaGVscGVyIC0tXHUwMDNlXG5cdTAwM2NzY3JpcHQge2Ake2Jhc2VOb1RyYWlsaW5nfS9tYWtlLXNjcm9sbGFibGUtY29kZS1mb2N1c2FibGUuanNgfSBpczppbmxpbmVcdTAwM2VcdTAwM2Mvc2NyaXB0XHUwMDNlXG5cblx1MDAzY3NjcmlwdCBzcmM9XCIvc3JjL3B3YS50c1wiXHUwMDNlXHUwMDNjL3NjcmlwdFx1MDAzZVxuXHUwMDNjIS0tIHRoaXMgZG9lcyBub3Qgd29yayBmb3Igc29tZSByZWFzb246IC0tXHUwMDNlXG5cdTAwM2MhLS0gXHUwMDNjc3R5bGUgaXM6Z2xvYmFsIGRlZmluZTp2YXJzPXtzdHJ1ZGVsVGhlbWV9XHUwMDNlXHUwMDNjL3N0eWxlXHUwMDNlIC0tXHUwMDNlXG5cdTAwM2MhLS0gdGhlIGZvbGxvd2luZyB2YXJpYWJsZXMgYXJlIGp1c3QgYSBmYWxsYmFjayB0byBtYWtlIHN1cmUgZXZlcnl0aGluZyBpcyByZWFkYWJsZSB3aXRob3V0IEpTIC0tXHUwMDNlXG5cdTAwM2NzdHlsZSBpczpnbG9iYWxcdTAwM2VcbiAgOnJvb3Qge1xuICAgIC0tYmFja2dyb3VuZDogIzIyMjtcbiAgICAtLWxpbmVCYWNrZ3JvdW5kOiAjMjIyMjIyOTk7XG4gICAgLS1mb3JlZ3JvdW5kOiAjZmZmO1xuICAgIC0tY2FyZXQ6ICNmZmNjMDA7XG4gICAgLS1zZWxlY3Rpb246IHJnYmEoMTI4LCAyMDMsIDE5NiwgMC41KTtcbiAgICAtLXNlbGVjdGlvbk1hdGNoOiAjMDM2ZGQ2MjY7XG4gICAgLS1saW5lSGlnaGxpZ2h0OiAjMDAwMDAwNTA7XG4gICAgLS1ndXR0ZXJCYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgICAtLWd1dHRlckZvcmVncm91bmQ6ICM4YTkxOTk2NjtcbiAgfVxuXHUwMDNjL3N0eWxlXHUwMDNlXG57cHdhSW5mbyBcdTAwMjZcdTAwMjYgXHUwMDNjRnJhZ21lbnQgc2V0Omh0bWw9e3B3YUluZm8ud2ViTWFuaWZlc3QubGlua1RhZ30gL1x1MDAzZX1cblxuXHUwMDNjc2NyaXB0XHUwMDNlXG4gIGltcG9ydCB7IGluaXRUaGVtZSwgY29kZW1pcnJvclNldHRpbmdzIH0gZnJvbSAnQHN0cnVkZWwvY29kZW1pcnJvcic7XG5cbiAgaW5pdFRoZW1lKGNvZGVtaXJyb3JTZXR0aW5ncy5nZXQoKS50aGVtZSk7XG5cbiAgLy8gaHR0cHM6Ly9tZWRpdW0uY29tL3F1aWNrLWNvZGUvMTAwdmgtcHJvYmxlbS13aXRoLWlvcy1zYWZhcmktOTJhYjIzYzg1MmE4XG4gIGNvbnN0IGFwcEhlaWdodCA9ICgpID1cdTAwM2Uge1xuICAgIGNvbnN0IGRvYyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcbiAgICBkb2Muc3R5bGUuc2V0UHJvcGVydHkoJy0tYXBwLWhlaWdodCcsIGAke3dpbmRvdy5pbm5lckhlaWdodCAtIDF9cHhgKTtcbiAgfTtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGFwcEhlaWdodCk7XG4gICAgYXBwSGVpZ2h0KCk7XG4gIH1cblx1MDAzYy9zY3JpcHRcdTAwM2UiXSwgIm1hcHBpbmdzIjogIkFBZ0RBLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNyRTtBQUNBLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzNDO0FBQ0EsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzVFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRTtBQUMxQixJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3hDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3hFLEVBQUUsQ0FBQztBQUNILEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUU7QUFDckMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2hELElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2YsRUFBRTtBQUFBOyIsICJuYW1lcyI6IFtdIH0=","// src/client/build/register.ts\nvar autoUpdateMode = \"true\";\nvar selfDestroying = \"false\";\nvar auto = autoUpdateMode === \"true\";\nvar autoDestroy = selfDestroying === \"true\";\nfunction registerSW(options = {}) {\n  const {\n    immediate = false,\n    onNeedRefresh,\n    onOfflineReady,\n    onRegistered,\n    onRegisteredSW,\n    onRegisterError\n  } = options;\n  let wb;\n  let registerPromise;\n  let sendSkipWaitingMessage;\n  const updateServiceWorker = async (_reloadPage = true) => {\n    await registerPromise;\n    if (!auto) {\n      await sendSkipWaitingMessage?.();\n    }\n  };\n  async function register() {\n    if (\"serviceWorker\" in navigator) {\n      const { Workbox } = await import(\"workbox-window\");\n      wb = new Workbox(\"/sw.js\", { scope: \"/\", type: \"classic\" });\n      sendSkipWaitingMessage = async () => {\n        await wb?.messageSkipWaiting();\n      };\n      if (!autoDestroy) {\n        if (auto) {\n          wb.addEventListener(\"activated\", (event) => {\n            if (event.isUpdate || event.isExternal)\n              window.location.reload();\n          });\n          wb.addEventListener(\"installed\", (event) => {\n            if (!event.isUpdate) {\n              onOfflineReady?.();\n            }\n          });\n        } else {\n          let onNeedRefreshCalled = false;\n          const showSkipWaitingPrompt = () => {\n            onNeedRefreshCalled = true;\n            wb?.addEventListener(\"controlling\", (event) => {\n              if (event.isUpdate)\n                window.location.reload();\n            });\n            onNeedRefresh?.();\n          };\n          wb.addEventListener(\"installed\", (event) => {\n            if (typeof event.isUpdate === \"undefined\") {\n              if (typeof event.isExternal !== \"undefined\") {\n                if (event.isExternal)\n                  showSkipWaitingPrompt();\n                else\n                  !onNeedRefreshCalled && onOfflineReady?.();\n              } else {\n                if (event.isExternal)\n                  window.location.reload();\n                else\n                  !onNeedRefreshCalled && onOfflineReady?.();\n              }\n            } else if (!event.isUpdate) {\n              onOfflineReady?.();\n            }\n          });\n          wb.addEventListener(\"waiting\", showSkipWaitingPrompt);\n          wb.addEventListener(\"externalwaiting\", showSkipWaitingPrompt);\n        }\n      }\n      wb.register({ immediate }).then((r) => {\n        if (onRegisteredSW)\n          onRegisteredSW(\"/sw.js\", r);\n        else\n          onRegistered?.(r);\n      }).catch((e) => {\n        onRegisterError?.(e);\n      });\n    }\n  }\n  registerPromise = register();\n  return updateServiceWorker;\n}\nexport {\n  registerSW\n};\n","import { registerSW } from 'virtual:pwa-register';\n\nregisterSW({\n  immediate: true,\n  onRegisteredSW(swScriptUrl) {\n    // console.log('SW registered: ', swScriptUrl)\n  },\n  onOfflineReady() {\n    // console.log('PWA application ready to work offline')\n  },\n});\n"],"file":"_astro/hoisted.Dhe9ajmj.js"}