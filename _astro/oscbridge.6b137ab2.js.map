{"version":3,"file":"oscbridge.6b137ab2.js","sources":["../../../packages/desktopbridge/oscbridge.mjs"],"sourcesContent":["import { parseNumeral, Pattern } from '@strudel.cycles/core';\nimport { Invoke } from './utils.mjs';\n\nPattern.prototype.osc = function () {\n  return this.onTrigger(async (time, hap, currentTime, cps = 1) => {\n    hap.ensureObjectValue();\n    const cycle = hap.wholeOrPart().begin.valueOf();\n    const delta = hap.duration.valueOf();\n    const controls = Object.assign({}, { cps, cycle, delta }, hap.value);\n    // make sure n and note are numbers\n    controls.n && (controls.n = parseNumeral(controls.n));\n    controls.note && (controls.note = parseNumeral(controls.note));\n\n    const params = [];\n\n    const timestamp = Math.round(Date.now() + (time - currentTime) * 1000);\n\n    Object.keys(controls).forEach((key) => {\n      const val = controls[key];\n      const value = typeof val === 'number' ? val.toString() : val;\n\n      if (value == null) {\n        return;\n      }\n      params.push({\n        name: key,\n        value,\n        valueisnumber: typeof val === 'number',\n      });\n    });\n\n    const messagesfromjs = [];\n    if (params.length) {\n      messagesfromjs.push({ target: '/dirt/play', timestamp, params });\n    }\n\n    if (messagesfromjs.length) {\n      setTimeout(() => {\n        Invoke('sendosc', { messagesfromjs });\n      });\n    }\n  });\n};\n"],"names":["Pattern","time","hap","currentTime","cps","cycle","delta","controls","parseNumeral","params","timestamp","key","val","value","messagesfromjs","Invoke"],"mappings":"gSAGAA,EAAQ,UAAU,IAAM,UAAY,CAClC,OAAO,KAAK,UAAU,MAAOC,EAAMC,EAAKC,EAAaC,EAAM,IAAM,CAC/DF,EAAI,kBAAiB,EACrB,MAAMG,EAAQH,EAAI,YAAa,EAAC,MAAM,QAAO,EACvCI,EAAQJ,EAAI,SAAS,QAAO,EAC5BK,EAAW,OAAO,OAAO,GAAI,CAAE,IAAAH,EAAK,MAAAC,EAAO,MAAAC,CAAK,EAAIJ,EAAI,KAAK,EAEnEK,EAAS,IAAMA,EAAS,EAAIC,EAAaD,EAAS,CAAC,GACnDA,EAAS,OAASA,EAAS,KAAOC,EAAaD,EAAS,IAAI,GAE5D,MAAME,EAAS,CAAA,EAETC,EAAY,KAAK,MAAM,KAAK,IAAK,GAAIT,EAAOE,GAAe,GAAI,EAErE,OAAO,KAAKI,CAAQ,EAAE,QAASI,GAAQ,CACrC,MAAMC,EAAML,EAASI,CAAG,EAClBE,EAAQ,OAAOD,GAAQ,SAAWA,EAAI,SAAU,EAAGA,EAErDC,GAAS,MAGbJ,EAAO,KAAK,CACV,KAAME,EACN,MAAAE,EACA,cAAe,OAAOD,GAAQ,QACtC,CAAO,CACP,CAAK,EAED,MAAME,EAAiB,CAAA,EACnBL,EAAO,QACTK,EAAe,KAAK,CAAE,OAAQ,aAAc,UAAAJ,EAAW,OAAAD,CAAM,CAAE,EAG7DK,EAAe,QACjB,WAAW,IAAM,CACfC,EAAO,UAAW,CAAE,eAAAD,CAAc,CAAE,CAC5C,CAAO,CAEP,CAAG,CACH"}