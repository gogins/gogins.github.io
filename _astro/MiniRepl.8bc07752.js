import{j as e}from"./jsx-runtime.0a78d354.js";import{r as o}from"./index.f3ddec24.js";import{w as L,n as Y,O as q}from"./index.86034b57.js";import{X as G,W as U,Y as X,T as $}from"./util.859c2705.js";import{a as F,f as J}from"./scope.4b7f6baa.js";import{S as K}from"./preload-helper.ea392ffd.js";import{C as Q}from"./Claviature.104f9d8c.js";import"./_commonjsHelpers.de833af9.js";/* empty css                       */function C({type:i}){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:{refresh:e.jsx("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"}),play:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"}),pause:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"}),stop:e.jsx("path",{fillRule:"evenodd",d:"M2 10a8 8 0 1116 0 8 8 0 01-16 0zm5-2.25A.75.75 0 017.75 7h4.5a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-4.5a.75.75 0 01-.75-.75v-4.5z",clipRule:"evenodd"})}[i]})}let M,N;typeof window<"u"&&(M=G(),N=U());function ce({tune:i,hideHeader:k=!1,canvasHeight:z=100,onTrigger:m,punchcard:s,punchcardLabels:H=!0,claviature:c,claviatureLabels:S}){const u=o.useMemo(()=>Z(),[]),g=o.useMemo(()=>`canvas-${u}`,[u]),A=!!s||!!c,T=!!s,v=s?[0,4]:[0,0],[O,P]=o.useState([]),B=o.useCallback(({code:t,shouldDraw:f})=>{const l=f?document.querySelector("#"+g)?.getContext("2d"):null;let j;f&&(j=(r,R,V,h)=>{h.length&&l?.clearRect(0,0,l.canvas.width*2,l.canvas.height*2),h?.forEach(p=>{p(l,R,r,v,{clear:!1})})});const d=new K({id:u,defaultOutput:F,getTime:()=>J().currentTime,transpiler:X,autodraw:!!f,root:w.current,initialCode:"// LOADING",pattern:L,drawTime:v,onDraw:j,editPattern:(r,R)=>(m&&(r=r.onTrigger(m,!1)),c&&d?.painters.push((V,h,p,ee)=>{const W=p.map(n=>n.value.note).filter(Boolean).map(n=>typeof n=="string"?Y(n):n);P(W)}),s&&d?.painters.push(q({labels:!!H})),r),prebake:async()=>Promise.all([N,M]),onUpdateState:r=>{E({...r})}});d.setCode(t),a.current=d},[]),[D,E]=o.useState({}),{started:x,isDirty:I,error:b}=D,a=o.useRef(),w=o.useRef();return $()?e.jsxs("div",{className:"overflow-hidden rounded-t-md bg-background border border-lineHighlight",children:[!k&&e.jsx("div",{className:"flex justify-between bg-lineHighlight",children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:y("cursor-pointer w-16 flex items-center justify-center p-1 border-r border-lineHighlight text-foreground bg-lineHighlight hover:bg-background",x?"animate-pulse":""),onClick:()=>a.current?.toggle(),children:e.jsx(C,{type:x?"stop":"play"})}),e.jsx("button",{className:y("w-16 flex items-center justify-center p-1 text-foreground border-lineHighlight bg-lineHighlight",I?"text-foreground hover:bg-background cursor-pointer":"opacity-50 cursor-not-allowed"),onClick:()=>a.current?.evaluate(),children:e.jsx(C,{type:"refresh"})})]})}),e.jsxs("div",{className:"overflow-auto relative p-1",children:[e.jsx("div",{ref:t=>{a.current||(w.current=t,B({code:i,shouldDraw:A}))}}),b&&e.jsx("div",{className:"text-right p-1 text-md text-red-200",children:b.message})]}),T&&e.jsx("canvas",{id:g,className:"w-full pointer-events-none border-t border-lineHighlight",height:z,ref:t=>{t&&t.width!==t.clientWidth&&(t.width=t.clientWidth)}}),c&&e.jsx(Q,{options:{range:["C2","C6"],scaleY:.75,colorize:[{keys:O,color:"steelblue"}],labels:S||{}}})]}):e.jsx("pre",{children:i})}function y(...i){return i.filter(Boolean).join(" ")}function Z(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}export{ce as MiniRepl};
//# sourceMappingURL=MiniRepl.8bc07752.js.map
