import{j as e}from"./jsx-runtime.XGodtQ4D.js";import{l as L,g as Q,q as ie,y as ce}from"./index.BqApzMOV.js";import{c as S,s as de,r as ue,d as he,e as me,f as pe,A as fe,g as x,h as xe,j as ge,k as H,m as je,n as ee,o as ve,q as K,v as be,w as we,x as ye,y as D,z as Ne,B as Ce,C as Ee,D as ke,E as Se,F as Re,u as Ae,G as z,H as te,l as Pe,p as M,b as Te,I as Fe,J as $e,K as Ie,L as Le,M as De,N as Me,O as _e,P as Oe}from"./useClient.OffH7qpv.js";import{s as Be,g as _,c as Ze,i as Ue,w as He}from"./scope.a_rP-DLk.js";import{j as Ke,t as ze,S as Ve,d as V}from"./preload-helper.L44mwuYi.js";import{r as l,R as We}from"./index.Nkt9jjly.js";/* empty css                       */import{u as ne}from"./useEvent.SpCUZMIs.js";function f(...t){return t.filter(Boolean).join(" ")}function qe({title:t,titleId:n,...s},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?l.createElement("title",{id:n},t):null,l.createElement("path",{fillRule:"evenodd",d:"M9.664 1.319a.75.75 0 0 1 .672 0 41.059 41.059 0 0 1 8.198 5.424.75.75 0 0 1-.254 1.285 31.372 31.372 0 0 0-7.86 3.83.75.75 0 0 1-.84 0 31.508 31.508 0 0 0-2.08-1.287V9.394c0-.244.116-.463.302-.592a35.504 35.504 0 0 1 3.305-2.033.75.75 0 0 0-.714-1.319 37 37 0 0 0-3.446 2.12A2.216 2.216 0 0 0 6 9.393v.38a31.293 31.293 0 0 0-4.28-1.746.75.75 0 0 1-.254-1.285 41.059 41.059 0 0 1 8.198-5.424ZM6 11.459a29.848 29.848 0 0 0-2.455-1.158 41.029 41.029 0 0 0-.39 3.114.75.75 0 0 0 .419.74c.528.256 1.046.53 1.554.82-.21.324-.455.63-.739.914a.75.75 0 1 0 1.06 1.06c.37-.369.69-.77.96-1.193a26.61 26.61 0 0 1 3.095 2.348.75.75 0 0 0 .992 0 26.547 26.547 0 0 1 5.93-3.95.75.75 0 0 0 .42-.739 41.053 41.053 0 0 0-.39-3.114 29.925 29.925 0 0 0-5.199 2.801 2.25 2.25 0 0 1-2.514 0c-.41-.275-.826-.541-1.25-.797a6.985 6.985 0 0 1-1.084 3.45 26.503 26.503 0 0 0-1.281-.78A5.487 5.487 0 0 0 6 12v-.54Z",clipRule:"evenodd"}))}const Xe=l.forwardRef(qe),Ge=Xe;function Je({title:t,titleId:n,...s},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?l.createElement("title",{id:n},t):null,l.createElement("path",{fillRule:"evenodd",d:"M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z",clipRule:"evenodd"}))}const Ye=l.forwardRef(Je),Qe=Ye;function et({title:t,titleId:n,...s},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?l.createElement("title",{id:n},t):null,l.createElement("path",{d:"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}),l.createElement("path",{d:"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}))}const tt=l.forwardRef(et),nt=tt;function st({title:t,titleId:n,...s},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?l.createElement("title",{id:n},t):null,l.createElement("path",{fillRule:"evenodd",d:"M2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm6.39-2.908a.75.75 0 0 1 .766.027l3.5 2.25a.75.75 0 0 1 0 1.262l-3.5 2.25A.75.75 0 0 1 8 12.25v-4.5a.75.75 0 0 1 .39-.658Z",clipRule:"evenodd"}))}const at=l.forwardRef(st),se=at;function lt({title:t,titleId:n,...s},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?l.createElement("title",{id:n},t):null,l.createElement("path",{d:"M15.98 1.804a1 1 0 0 0-1.96 0l-.24 1.192a1 1 0 0 1-.784.785l-1.192.238a1 1 0 0 0 0 1.962l1.192.238a1 1 0 0 1 .785.785l.238 1.192a1 1 0 0 0 1.962 0l.238-1.192a1 1 0 0 1 .785-.785l1.192-.238a1 1 0 0 0 0-1.962l-1.192-.238a1 1 0 0 1-.785-.785l-.238-1.192ZM6.949 5.684a1 1 0 0 0-1.898 0l-.683 2.051a1 1 0 0 1-.633.633l-2.051.683a1 1 0 0 0 0 1.898l2.051.684a1 1 0 0 1 .633.632l.683 2.051a1 1 0 0 0 1.898 0l.683-2.051a1 1 0 0 1 .633-.633l2.051-.683a1 1 0 0 0 0-1.898l-2.051-.683a1 1 0 0 1-.633-.633L6.95 5.684ZM13.949 13.684a1 1 0 0 0-1.898 0l-.184.551a1 1 0 0 1-.632.633l-.551.183a1 1 0 0 0 0 1.898l.551.183a1 1 0 0 1 .633.633l.183.551a1 1 0 0 0 1.898 0l.184-.551a1 1 0 0 1 .632-.633l.551-.183a1 1 0 0 0 0-1.898l-.551-.184a1 1 0 0 1-.633-.632l-.183-.551Z"}))}const rt=l.forwardRef(lt),ot=rt;function it({title:t,titleId:n,...s},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?l.createElement("title",{id:n},t):null,l.createElement("path",{fillRule:"evenodd",d:"M2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm5-2.25A.75.75 0 0 1 7.75 7h4.5a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-4.5Z",clipRule:"evenodd"}))}const ct=l.forwardRef(it),dt=ct,{BASE_URL:$}={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://strudel.cc/",ASSETS_PREFIX:void 0},ut=$.endsWith("/")?$.slice(0,-1):$;function ht({context:t}){const{embedded:n,started:s,pending:r,isDirty:a,activeCode:c,handleTogglePlay:d,handleUpdate:o,handleShuffle:m,handleShare:v}=t,u=typeof window<"u"&&(n||window.location!==window.parent.location),{isZen:g}=S();return e.jsxs("header",{id:"header",className:f("flex-none text-black  z-[100] text-lg select-none",!g&&!u&&"bg-lineHighlight",g?"h-12 w-8 fixed top-0 left-0":"sticky top-0 w-full py-1 justify-between",u?"flex":"md:flex"),children:[e.jsx("div",{className:"px-4 flex space-x-2 md:pt-0 select-none",children:e.jsxs("h1",{onClick:()=>{u&&window.open(window.location.href.replace("embed",""))},className:f(u?"text-l cursor-pointer":"text-xl","text-foreground font-bold flex space-x-2 items-center"),children:[e.jsx("div",{className:f("mt-[1px]",s&&"animate-spin","cursor-pointer"),onClick:()=>{u||de(!g)},children:"ðŸŒ€"}),!g&&e.jsxs("div",{className:f(s&&"animate-pulse"),children:[e.jsx("span",{className:"",children:"strudel"})," ",e.jsx("span",{className:"text-sm",children:"REPL"})]})]})}),!g&&e.jsxs("div",{className:"flex max-w-full overflow-auto text-foreground",children:[e.jsx("button",{onClick:d,title:s?"stop":"play",className:f(u?"px-2":"p-2","hover:opacity-50",!s&&"animate-pulse"),children:r?e.jsx(e.Fragment,{children:"loading..."}):e.jsxs("span",{className:f("flex items-center space-x-1",u?"":"w-16"),children:[s?e.jsx(dt,{className:"w-6 h-6"}):e.jsx(se,{className:"w-6 h-6"}),!u&&e.jsx("span",{children:s?"stop":"play"})]})}),e.jsxs("button",{onClick:()=>o(),title:"update",className:f("flex items-center space-x-1",u?"px-2":"p-2",!a||!c?"opacity-50":"hover:opacity-50"),children:[e.jsx(Qe,{className:"w-6 h-6"}),!u&&e.jsx("span",{children:"update"})]}),!u&&e.jsxs("button",{title:"shuffle",className:"hover:opacity-50 p-2 flex items-center space-x-1",onClick:m,children:[e.jsx(ot,{className:"w-6 h-6"}),e.jsx("span",{children:" shuffle"})]}),!u&&e.jsxs("button",{title:"share",className:f("cursor-pointer hover:opacity-50 flex items-center space-x-1",u?"px-2":"p-2"),onClick:v,children:[e.jsx(nt,{className:"w-6 h-6"}),e.jsx("span",{children:"share"})]}),!u&&e.jsxs("a",{title:"learn",href:`${ut}/workshop/getting-started/`,className:f("hover:opacity-50 flex items-center space-x-1",u?"px-2":"p-2"),children:[e.jsx(Ge,{className:"w-6 h-6"}),e.jsx("span",{children:"learn"})]})]})]})}function mt({active:t}){return e.jsx("div",{className:"overflow-hidden opacity-50 fixed top-0 left-0 w-full z-[1000]",children:e.jsx("div",{className:f("h-[2px] block w-full",t?"bg-foreground animate-train":"bg-transparent"),children:e.jsx("div",{})})})}function pt({title:t,titleId:n,...s},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?l.createElement("title",{id:n},t):null,l.createElement("path",{d:"M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"}))}const ft=l.forwardRef(pt),xt=ft;function gt({log:t}){return e.jsxs("div",{id:"console-tab",className:"break-all px-4 dark:text-white text-stone-900 text-sm",children:[e.jsx("pre",{children:`â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     
â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘     
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘     
â•šâ•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘     
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•`}),t.map((n,s)=>{const r=jt(n.message);return e.jsxs("div",{className:f(n.type==="error"&&"text-red-500",n.type==="highlight"&&"underline"),children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:r}}),n.count?` (${n.count})`:""]},n.id)})]})}function jt(t){var n,s,r,a;return s=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,n=t.replace(s,'<a class="underline" href="$1" target="_blank">$1</a>'),r=/(^|[^\/])(www\.[\S]+(\b|$))/gim,n=n.replace(r,'$1<a class="underline" href="http://$2" target="_blank">$2</a>'),a=/(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim,n=n.replace(a,'<a class="underline" href="mailto:$1">$1</a>'),n}function vt(){const[t,n]=l.useState([]);l.useEffect(()=>(ue("",{dir:he,recursive:!0}).then(o=>n([{name:"~/music",children:o}])).catch(o=>{console.log("error loadin files",o)}),()=>{}),[]);const s=l.useMemo(()=>t[t.length-1],[t]),r=l.useMemo(()=>t.slice(1).map(o=>o.name).join("/"),[t]),a=l.useMemo(()=>s?.children.filter(o=>!!o.children),[s]),c=l.useMemo(()=>s?.children.filter(o=>!o.children&&me(o.name)),[s]),d=o=>n(m=>m.concat([o]));return e.jsxs("div",{className:"px-4 flex flex-col h-full",children:[e.jsx("div",{className:"flex justify-between font-mono pb-1",children:e.jsxs("div",{children:[e.jsx("span",{children:"samples('"}),t?.map((o,m)=>m<t.length-1?e.jsxs(l.Fragment,{children:[e.jsx("span",{className:"cursor-pointer underline",onClick:()=>n(v=>v.slice(0,m+1)),children:o.name}),e.jsx("span",{children:"/"})]},m):e.jsx("span",{className:"cursor-pointer underline",children:o.name},m)),e.jsx("span",{children:"')"})]})}),e.jsxs("div",{className:"overflow-auto",children:[!a?.length&&!c?.length&&e.jsx("span",{className:"text-gray-500",children:"Nothing here"}),a?.map((o,m)=>e.jsx("div",{className:"cursor-pointer",onClick:()=>d(o),children:o.name},m)),c?.map((o,m)=>e.jsx("div",{className:"text-gray-500 cursor-pointer select-none",onClick:async()=>pe(`${r}/${o.name}`),children:o.name},m))]})]})}const W=Ke.docs.filter(({name:t,description:n})=>t&&!t.startsWith("_")&&!!n).sort((t,n)=>t.name.localeCompare(n.name)),bt=t=>{var n=document.createElement("div");return n.innerHTML=t,n.textContent||n.innerText||""};function wt(){return e.jsxs("div",{className:"flex h-full w-full pt-2 text-foreground overflow-hidden",children:[e.jsx("div",{className:"w-42 flex-none h-full overflow-y-auto overflow-x-hidden pr-4",children:W.map((t,n)=>e.jsxs("a",{className:"cursor-pointer block hover:bg-lineHighlight py-1 px-4",onClick:()=>{const s=document.getElementById(`doc-${n}`);document.getElementById("reference-container").scrollTo(0,s.offsetTop)},children:[t.name," "]},n))}),e.jsx("div",{className:"break-normal w-full h-full overflow-auto pl-4 flex relative",id:"reference-container",children:e.jsxs("div",{className:"prose dark:prose-invert max-w-full pr-4",children:[e.jsx("h2",{children:"API Reference"}),e.jsx("p",{children:"This is the long list functions you can use! Remember that you don't need to remember all of those and that you can already make music with a small set of functions!"}),W.map((t,n)=>e.jsxs("section",{children:[e.jsx("h3",{id:`doc-${n}`,children:t.name}),!!t.synonyms_text&&e.jsxs("p",{children:["Synonyms: ",e.jsx("code",{children:t.synonyms_text})]}),e.jsx("p",{dangerouslySetInnerHTML:{__html:t.description}}),e.jsx("ul",{children:t.params?.map(({name:s,type:r,description:a},c)=>e.jsxs("li",{children:[s," : ",r.names?.join(" | ")," ",a?e.jsxs(e.Fragment,{children:[" - ",bt(a)]}):""]},c))}),t.examples?.map((s,r)=>e.jsx("pre",{children:s},r))]},n))]})})]})}function O({value:t,onChange:n,items:s}){return e.jsx("div",{className:"flex max-w-lg",children:Object.entries(s).map(([r,a],c,d)=>e.jsx("button",{onClick:()=>n(r),className:f("px-2 border-b h-8 whitespace-nowrap",t===r?"border-foreground":"border-transparent"),children:a.toLowerCase()},r))})}function C({label:t,value:n,onChange:s}){return e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:n,onChange:s})," "+t]})}function q({value:t,options:n,onChange:s}){return e.jsx("select",{className:"p-2 bg-background rounded-md text-foreground",value:t,onChange:r=>s(r.target.value),children:Object.entries(n).map(([r,a])=>e.jsx("option",{className:"bg-background",value:r,children:a},r))})}function yt({value:t,onChange:n,step:s=1,...r}){return e.jsxs("div",{className:"flex space-x-2 gap-1",children:[e.jsx("input",{className:"p-2 grow",type:"range",value:t,step:s,onChange:a=>n(Number(a.target.value)),...r}),e.jsx("input",{type:"number",value:t,step:s,className:"w-16 bg-background rounded-md",onChange:a=>n(Number(a.target.value))})]})}function N({label:t,children:n}){return e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{children:t}),n]})}const Nt=Object.fromEntries(Object.keys(ze).map(t=>[t,t])),Ct={monospace:"monospace",BigBlueTerminal:"BigBlueTerminal",x3270:"x3270",PressStart:"PressStart2P",galactico:"galactico","we-come-in-peace":"we-come-in-peace",FiraCode:"FiraCode","FiraCode-SemiBold":"FiraCode SemiBold",teletext:"teletext",mode7:"mode7"};function Et({started:t}){const{theme:n,keybindings:s,isLineNumbersDisplayed:r,isPatternHighlightingEnabled:a,isActiveLineHighlighted:c,isAutoCompletionEnabled:d,isTooltipEnabled:o,isFlashEnabled:m,isLineWrappingEnabled:v,fontSize:u,fontFamily:g,panelPosition:h,audioDeviceName:w}=S();return e.jsxs("div",{className:"text-foreground p-4 space-y-4",children:[AudioContext.prototype.setSinkId!=null&&e.jsx(N,{label:"Audio Output Device",children:e.jsx(fe,{isDisabled:t,audioDeviceName:w,onChange:i=>x.setKey("audioDeviceName",i)})}),e.jsx(N,{label:"Theme",children:e.jsx(q,{options:Nt,value:n,onChange:i=>x.setKey("theme",i)})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(N,{label:"Font Family",children:e.jsx(q,{options:Ct,value:g,onChange:i=>x.setKey("fontFamily",i)})}),e.jsx(N,{label:"Font Size",children:e.jsx(yt,{value:u,onChange:i=>x.setKey("fontSize",i),min:10,max:40,step:2})})]}),e.jsx(N,{label:"Keybindings",children:e.jsx(O,{value:s,onChange:i=>x.setKey("keybindings",i),items:{codemirror:"Codemirror",vim:"Vim",emacs:"Emacs",vscode:"VSCode"}})}),e.jsx(N,{label:"Panel Position",children:e.jsx(O,{value:h,onChange:i=>x.setKey("panelPosition",i),items:{bottom:"Bottom",right:"Right"}})}),e.jsxs(N,{label:"Code Settings",children:[e.jsx(C,{label:"Display line numbers",onChange:i=>x.setKey("isLineNumbersDisplayed",i.target.checked),value:r}),e.jsx(C,{label:"Highlight active line",onChange:i=>x.setKey("isActiveLineHighlighted",i.target.checked),value:c}),e.jsx(C,{label:"Highlight events in code",onChange:i=>x.setKey("isPatternHighlightingEnabled",i.target.checked),value:a}),e.jsx(C,{label:"Enable auto-completion",onChange:i=>x.setKey("isAutoCompletionEnabled",i.target.checked),value:d}),e.jsx(C,{label:"Enable tooltips on Ctrl and hover",onChange:i=>x.setKey("isTooltipEnabled",i.target.checked),value:o}),e.jsx(C,{label:"Enable line wrapping",onChange:i=>x.setKey("isLineWrappingEnabled",i.target.checked),value:v}),e.jsx(C,{label:"Enable flashing on evaluation",onChange:i=>x.setKey("isFlashEnabled",i.target.checked),value:m})]}),e.jsx(N,{label:"Zen Mode",children:"Try clicking the logo in the top left!"}),e.jsx(N,{label:"Reset Settings",children:e.jsx("button",{className:"bg-background p-2 max-w-[300px] rounded-md hover:opacity-50",onClick:()=>{confirm("Sure?")&&x.set(xe)},children:"restore default settings"})})]})}function kt({onComplete:t}){let n=We.createRef();const[s,r]=l.useState(!1),a=l.useCallback(async()=>{n.current.files?.length&&(r(!0),await ge(H,n.current.files).then(()=>{je(H,()=>{t(),r(!1)})}))});return e.jsxs("label",{style:{alignItems:"center"},className:"flex bg-background ml-2 pl-2 pr-2 max-w-[300px] rounded-md hover:opacity-50 whitespace-nowrap cursor-pointer",children:[e.jsx("input",{disabled:s,ref:n,id:"audio_file",style:{display:"none"},type:"file",directory:"",webkitdirectory:"",multiple:!0,accept:"audio/*",onChange:()=>{a()}}),s?"importing...":"import sounds"]})}const St=t=>Array.isArray(t)?t.length:typeof t=="object"?Object.values(t).length:1;function Rt(){const t=ee(Be),{soundsFilter:n}=S(),s=l.useMemo(()=>{let a=Object.entries(t).filter(([c])=>!c.startsWith("_"));return t?n==="user"?a.filter(([c,{data:d}])=>!d.prebake):n==="drums"?a.filter(([c,{data:d}])=>d.type==="sample"&&d.tag==="drum-machines"):n==="samples"?a.filter(([c,{data:d}])=>d.type==="sample"&&d.tag!=="drum-machines"):n==="synths"?a.filter(([c,{data:d}])=>["synth","soundfont"].includes(d.type)):a:[]},[t,n]),r=l.useRef();return ne("mouseup",()=>{const a=r.current;r.current=void 0,a?.then(c=>{c?.stop(_().currentTime+.01)})}),e.jsxs("div",{id:"sounds-tab",className:"px-4 flex flex-col w-full h-full dark:text-white text-stone-900",children:[e.jsxs("div",{className:"pb-2 flex shrink-0 overflow-auto",children:[e.jsx(O,{value:n,onChange:a=>x.setKey("soundsFilter",a),items:{samples:"samples",drums:"drum-machines",synths:"Synths",user:"User"}}),e.jsx(kt,{onComplete:()=>x.setKey("soundsFilter","user")})]}),e.jsxs("div",{className:"min-h-0 max-h-full grow overflow-auto font-mono text-sm break-normal",children:[s.map(([a,{data:c,onTrigger:d}])=>e.jsxs("span",{className:"cursor-pointer hover:opacity-50",onMouseDown:async()=>{const o=_(),m={note:["synth","soundfont"].includes(c.type)?"a3":void 0,s:a,clip:1,release:.5},v=o.currentTime+.05,u=()=>r.current?.node?.disconnect();r.current=Promise.resolve(d(v,m,u)),r.current.then(g=>{Ze(g?.node)})},children:[" ",a,c?.type==="sample"?`(${St(c.samples)})`:"",c?.type==="soundfont"?`(${c.fonts.length})`:""]},a)),s.length?"":"No custom sounds loaded in this pattern (yet)."]})]})}const{BASE_URL:I}={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://strudel.cc/",ASSETS_PREFIX:void 0},At=I.endsWith("/")?I.slice(0,-1):I;function Pt({context:t}){return e.jsxs("div",{className:"prose dark:prose-invert max-w-[600px] pt-2 font-sans pb-8 px-4",children:[e.jsxs("h3",{children:[e.jsx("span",{className:f("animate-spin inline-block select-none"),children:"ðŸŒ€"})," welcome"]}),e.jsxs("p",{children:["You have found ",e.jsx("span",{className:"underline",children:"strudel"}),", a new live coding platform to write dynamic music pieces in the browser! It is free and open-source and made for beginners and experts alike. To get started:",e.jsx("br",{}),e.jsx("br",{}),e.jsx("span",{className:"underline",children:"1. hit play"})," - ",e.jsx("span",{className:"underline",children:"2. change something"})," -"," ",e.jsx("span",{className:"underline",children:"3. hit update"}),e.jsx("br",{}),"If you don't like what you hear, try ",e.jsx("span",{className:"underline",children:"shuffle"}),"!"]}),e.jsxs("p",{children:["To learn more about what this all means, check out the"," ",e.jsx("a",{href:`${At}/workshop/getting-started/`,target:"_blank",children:"interactive tutorial"}),". Also feel free to join the"," ",e.jsx("a",{href:"https://discord.com/invite/HGEdXmRkzT",target:"_blank",children:"tidalcycles discord channel"})," ","to ask any questions, give feedback or just say hello."]}),e.jsx("h3",{children:"about"}),e.jsxs("p",{children:["strudel is a JavaScript version of"," ",e.jsx("a",{href:"https://tidalcycles.org/",target:"_blank",children:"tidalcycles"}),", which is a popular live coding language for music, written in Haskell. You can find the source code at"," ",e.jsx("a",{href:"https://github.com/tidalcycles/strudel",target:"_blank",children:"github"}),". Please consider to"," ",e.jsx("a",{href:"https://opencollective.com/tidalcycles",target:"_blank",children:"support this project"})," ","to ensure ongoing development ðŸ’–"]})]})}function Tt({title:t,titleId:n,...s},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?l.createElement("title",{id:n},t):null,l.createElement("path",{d:"M7 3.5A1.5 1.5 0 0 1 8.5 2h3.879a1.5 1.5 0 0 1 1.06.44l3.122 3.12A1.5 1.5 0 0 1 17 6.622V12.5a1.5 1.5 0 0 1-1.5 1.5h-1v-3.379a3 3 0 0 0-.879-2.121L10.5 5.379A3 3 0 0 0 8.379 4.5H7v-1Z"}),l.createElement("path",{d:"M4.5 6A1.5 1.5 0 0 0 3 7.5v9A1.5 1.5 0 0 0 4.5 18h7a1.5 1.5 0 0 0 1.5-1.5v-5.879a1.5 1.5 0 0 0-.44-1.06L9.44 6.439A1.5 1.5 0 0 0 8.378 6H4.5Z"}))}const Ft=l.forwardRef(Tt),$t=Ft;function It({title:t,titleId:n,...s},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?l.createElement("title",{id:n},t):null,l.createElement("path",{d:"m5.433 13.917 1.262-3.155A4 4 0 0 1 7.58 9.42l6.92-6.918a2.121 2.121 0 0 1 3 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 0 1-.65-.65Z"}),l.createElement("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0 0 10 3H4.75A2.75 2.75 0 0 0 2 5.75v9.5A2.75 2.75 0 0 0 4.75 18h9.5A2.75 2.75 0 0 0 17 15.25V10a.75.75 0 0 0-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5Z"}))}const Lt=l.forwardRef(It),Dt=Lt;function Mt({title:t,titleId:n,...s},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?l.createElement("title",{id:n},t):null,l.createElement("path",{fillRule:"evenodd",d:"M8.75 1A2.75 2.75 0 0 0 6 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 1 0 .23 1.482l.149-.022.841 10.518A2.75 2.75 0 0 0 7.596 19h4.807a2.75 2.75 0 0 0 2.742-2.53l.841-10.52.149.023a.75.75 0 0 0 .23-1.482A41.03 41.03 0 0 0 14 4.193V3.75A2.75 2.75 0 0 0 11.25 1h-2.5ZM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4ZM8.58 7.72a.75.75 0 0 0-1.5.06l.3 7.5a.75.75 0 1 0 1.5-.06l-.3-7.5Zm4.34.06a.75.75 0 1 0-1.5-.06l-.3 7.5a.75.75 0 1 0 1.5.06l.3-7.5Z",clipRule:"evenodd"}))}const _t=l.forwardRef(Mt),Ot=_t;function X(...t){return t.filter(Boolean).join(" ")}function Bt({context:t}){const{userPatterns:n}=S(),s=ve(),r=l.useMemo(()=>s&&!!K[s],[s]);return e.jsxs("div",{className:"px-4 w-full dark:text-white text-stone-900 space-y-4 pb-4",children:[e.jsxs("section",{children:[s&&e.jsxs("div",{className:"flex items-center mb-2 space-x-2 overflow-auto",children:[e.jsx("h1",{className:"text-xl",children:s}),e.jsxs("div",{className:"space-x-4 flex w-min",children:[!r&&e.jsx("button",{className:"hover:opacity-50",onClick:()=>be(),title:"Rename",children:e.jsx(Dt,{className:"w-5 h-5"})}),e.jsx("button",{className:"hover:opacity-50",onClick:()=>we(),title:"Duplicate",children:e.jsx($t,{className:"w-5 h-5"})}),!r&&e.jsx("button",{className:"hover:opacity-50",onClick:()=>ye(),title:"Delete",children:e.jsx(Ot,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"font-mono text-sm",children:Object.entries(n).map(([a,c])=>e.jsx("a",{className:X("mr-4 hover:opacity-50 cursor-pointer inline-block",a===s?"outline outline-1":""),onClick:()=>{const{code:d}=c;D(a),t.handleUpdate(d,!0)},children:a},a))}),e.jsxs("div",{className:"pr-4 space-x-4 border-b border-foreground mb-2 h-8 flex overflow-auto max-w-full items-center",children:[e.jsx("button",{className:"hover:opacity-50",onClick:()=>{const a=Ne(),{code:c}=Ce(a);t.handleUpdate(c,!0)},children:"new"}),e.jsx("button",{className:"hover:opacity-50",onClick:()=>Ee(),children:"clear"}),e.jsxs("label",{className:"hover:opacity-50 cursor-pointer",children:[e.jsx("input",{style:{display:"none"},type:"file",multiple:!0,accept:"text/plain,application/json",onChange:a=>ke(a.target.files)}),"import"]}),e.jsx("button",{className:"hover:opacity-50",onClick:()=>Se(),children:"export"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl mb-2",children:"Examples"}),e.jsx("div",{className:"font-mono text-sm",children:Object.entries(K).map(([a,c])=>e.jsx("a",{className:X("mr-4 hover:opacity-50 cursor-pointer inline-block",a===s?"outline outline-1":""),onClick:()=>{D(a),t.handleUpdate(c,!0)},children:a},a))})]})]})}const G=typeof window<"u"?l.useLayoutEffect:l.useEffect,Zt=typeof window<"u"&&window.__TAURI__;function J({context:t}){const n=l.useRef(),[s,r]=l.useState([]),{activeFooter:a,isZen:c,panelPosition:d}=S();G(()=>{n.current&&a==="console"&&(n.current.scrollTop=n.current?.scrollHeight)},[s,a]),G(()=>{n.current&&(a==="console"?n.current.scrollTop=n.current?.scrollHeight:n.current.scrollTop=0)},[a]),Ut(l.useCallback(g=>{const{message:h,type:w,data:i}=g.detail;r(b=>{const R=b.length?b[b.length-1]:void 0,A=Re(12);if(w==="loaded-sample"){const Z=b.findIndex(({data:{url:E},type:p})=>p==="load-sample"&&E===i.url);b[Z]={message:h,type:w,id:A,data:i}}else R&&R.message===h?b=b.slice(0,-1).concat([{message:h,type:w,count:(R.count??1)+1,id:A,data:i}]):b=b.concat([{message:h,type:w,id:A,data:i}]);return b.slice(-20)})},[]));const o=({children:g,name:h,label:w})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:()=>z(h),className:f("h-8 px-2 text-foreground cursor-pointer hover:opacity-50 flex items-center space-x-1 border-b",a===h?"border-foreground":"border-transparent"),children:w||h}),a===h&&e.jsx(e.Fragment,{children:g})]}),m=Ae();if(c)return null;const v=a!=="";let u={right:f("max-w-full flex-grow-0 flex-none overflow-hidden",v?"w-[600px] h-full":"absolute right-0"),bottom:f("relative",v?"h-[360px] min-h-[360px]":"")};return m?e.jsxs("nav",{className:f("bg-lineHighlight z-[10] flex flex-col",u[d]),children:[e.jsxs("div",{className:"flex justify-between px-2",children:[e.jsxs("div",{className:f("flex select-none max-w-full overflow-auto",a&&"pb-2"),children:[e.jsx(o,{name:"intro",label:"welcome"}),e.jsx(o,{name:"patterns"}),e.jsx(o,{name:"sounds"}),e.jsx(o,{name:"console"}),e.jsx(o,{name:"reference"}),e.jsx(o,{name:"settings"}),Zt&&e.jsx(o,{name:"files"})]}),a!==""&&e.jsx("button",{onClick:()=>z(""),className:"text-foreground px-2","aria-label":"Close Panel",children:e.jsx(xt,{className:"w-5 h-5"})})]}),a!==""&&e.jsx("div",{className:"relative overflow-hidden",children:e.jsxs("div",{className:"text-white overflow-auto h-full max-w-full",ref:n,children:[a==="intro"&&e.jsx(Pt,{context:t}),a==="patterns"&&e.jsx(Bt,{context:t}),a==="console"&&e.jsx(gt,{log:s}),a==="sounds"&&e.jsx(Rt,{}),a==="reference"&&e.jsx(wt,{}),a==="settings"&&e.jsx(Et,{started:t.started}),a==="files"&&e.jsx(vt,{})]})})]}):null}function Ut(t){ne(L.key,t)}const{code:Ht,name:Kt}=te(),zt=l.createContext(null),{latestCode:Y}=x.get();let ae,le,F,B,re;typeof window<"u"&&(Ue(),ae=Pe(),le=M(),F=Q(),B=()=>F.clearRect(0,0,F.canvas.height,F.canvas.width),re=window.location!==window.parent.location);function tn({embedded:t=!1}){const n=t||re,{panelPosition:s,isZen:r}=S(),a=l.useCallback(()=>{const p=[-2,2],j=Q(),P=(y,k,Vt,U)=>{U.length&&j.clearRect(0,0,j.canvas.width*2,j.canvas.height*2),U?.forEach(oe=>{oe(j,k,y,p,{clear:!1})})},T=new Ve({defaultOutput:He,getTime:()=>_().currentTime,transpiler:Te,autodraw:!1,root:w.current,initialCode:"// LOADING",pattern:ie,drawTime:p,onDraw:P,prebake:async()=>Promise.all([ae,le]),onUpdateState:y=>{d({...y})},afterEval:({code:y})=>{Fe(y),$e(y),window.location.hash="#"+ce(y)},bgFill:!1});Ie().then(y=>{let k;y?(T.setCode(y),Le(y),k="I have loaded the code from the URL."):Y?(T.setCode(Y),k="Your last session has been loaded!"):(T.setCode(Ht),k=`A random code snippet named "${Kt}" has been loaded!`),L(`Welcome to Strudel! ${k} Press play or hit ctrl+enter to run it!`,"highlight")}),h.current=T},[]),[c,d]=l.useState({}),{started:o,isDirty:m,error:v,activeCode:u,pending:g}=c,h=l.useRef(),w=l.useRef(),i=ee(x,{keys:Object.keys(V)});l.useEffect(()=>{let p={};Object.keys(V).forEach(j=>{i.hasOwnProperty(j)&&(p[j]=i[j])}),h.current?.updateSettings(p)},[i]),l.useEffect(()=>{const{audioDeviceName:p}=i;p!==De&&Me().then(j=>{const P=j.get(p);P!=null&&_e(P)})},[]);const b=async()=>h.current?.toggle(),E={embedded:t,started:o,pending:g,isDirty:m,activeCode:u,handleTogglePlay:b,handleUpdate:async(p,j=!1)=>{j&&(B(),resetLoadedSounds(),h.current.repl.setCps(1),await M()),p?(h.current.setCode(p),h.current.repl.evaluate(p)):m&&h.current.evaluate()},handleShuffle:async()=>{const{code:p,name:j}=te();L(`[repl] âœ¨ loading random tune "${j}"`),D(j),B(),resetLoadedSounds(),h.current.repl.setCps(1),await M(),h.current.setCode(p),h.current.repl.evaluate(p)},handleShare:async()=>Oe(u)};return e.jsx(zt.Provider,{value:E,children:e.jsxs("div",{className:f("h-full flex flex-col relative"),children:[e.jsx(mt,{active:g}),e.jsx(ht,{context:E}),n&&!o&&e.jsxs("button",{onClick:()=>b(),className:"text-white text-2xl fixed left-[50%] top-[50%] translate-x-[-50%] translate-y-[-50%] z-[1000] m-auto p-4 bg-black rounded-md flex items-center space-x-2",children:[e.jsx(se,{className:"w-6 h-6"}),e.jsx("span",{children:"play"})]}),e.jsxs("div",{className:"grow flex relative overflow-hidden",children:[e.jsx("section",{className:"text-gray-100 cursor-text pb-0 overflow-auto grow"+(r?" px-10":""),id:"code",ref:p=>{w.current=p,h.current||a()}}),s==="right"&&!n&&e.jsx(J,{context:E})]}),v&&e.jsx("div",{className:"text-red-500 p-4 bg-lineHighlight animate-pulse",children:v.message||"Unknown Error :-/"}),s==="bottom"&&!n&&e.jsx(J,{context:E})]})})}export{tn as Repl};
