import{P as m}from"./settings.ea7ba944.js";import"./index.528e429e.js";var c,g=!1;async function y(a=38400){if(!g){if(g=!0,c)return c;if("serial"in navigator){const o=await navigator.serial.requestPort();await o.open({baudRate:a});const t=new TextEncoder,n=o.writable.getWriter();c=function(f,s){const r=t.encode(f);if(!s)n.write(r);else{const i=new Uint8Array(4);i[0]=124,i[1]=s>>8&255,i[2]=s&255,i[3]=59;const e=new Uint8Array(r.length+4);e.set(r),e.set(i,r.length),n.write(e)}}}else throw"Webserial is not available in this browser."}}const A=.1;function T(a){const o=a.length;if(o==0)return 0;for(var t=65535,n=0;n<o;++n){t^=a.charCodeAt(n)<<8;for(var f=0;f<8;++f)t=(t&32768)>0?t<<1^4129:t<<1}return t&65535}m.prototype.serial=function(a=38400,o=!1,t=!1){return this.withHap(n=>{c||y(a);const f=(s,r,i)=>{var e="",v=0;if(typeof r.value=="object")if("action"in r.value){var u=r.value.action;t&&(u=u.charAt(0)),e+=u+"(";var w=!0;for(var[l,x]of Object.entries(r.value))l!=="action"&&(w?w=!1:e+=",",t&&(l=l.charAt(0)),e+=l+":"+x);e+=")",o&&(v=T(e))}else for(const[d,h]of Object.entries(r.value))e+=`${d}:${h}`;else e=r.value;const b=(s-i+A)*1e3;window.setTimeout(function(){c(e,v)},b)};return n.setContext({...n.context,onTrigger:f,dominantTrigger:!0})})};export{y as getWriter};
