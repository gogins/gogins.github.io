{"version":3,"file":"TableOfContents.CFGpOuxi.js","sources":["../../../node_modules/.pnpm/html-escaper@3.0.3/node_modules/html-escaper/esm/index.js","../../src/components/RightSidebar/TableOfContents.tsx"],"sourcesContent":["/**\n * Copyright (C) 2017-present by Andrea Giammarchi - @WebReflection\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nconst {replace} = '';\n\n// escape\nconst es = /&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g;\nconst ca = /[&<>'\"]/g;\n\nconst esca = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  \"'\": '&#39;',\n  '\"': '&quot;'\n};\nconst pe = m => esca[m];\n\n/**\n * Safely escape HTML entities such as `&`, `<`, `>`, `\"`, and `'`.\n * @param {string} es the input to safely escape\n * @returns {string} the escaped input, and it **throws** an error if\n *  the input type is unexpected, except for boolean and numbers,\n *  converted as string.\n */\nexport const escape = es => replace.call(es, ca, pe);\n\n\n// unescape\nconst unes = {\n  '&amp;': '&',\n  '&#38;': '&',\n  '&lt;': '<',\n  '&#60;': '<',\n  '&gt;': '>',\n  '&#62;': '>',\n  '&apos;': \"'\",\n  '&#39;': \"'\",\n  '&quot;': '\"',\n  '&#34;': '\"'\n};\nconst cape = m => unes[m];\n\n/**\n * Safely unescape previously escaped entities such as `&`, `<`, `>`, `\"`,\n * and `'`.\n * @param {string} un a previously escaped string\n * @returns {string} the unescaped input, and it **throws** an error if\n *  the input type is unexpected, except for boolean and numbers,\n *  converted as string.\n */\nexport const unescape = un => replace.call(un, es, cape);\n","import { unescape } from 'html-escaper';\nimport type { MarkdownHeading } from 'astro';\nimport type { FC } from 'react';\nimport { useState, useEffect, useRef } from 'react';\n\ntype ItemOffsets = {\n  id: string;\n  topOffset: number;\n};\n\nconst TableOfContents: FC<{ headings: MarkdownHeading[]; currentPage: string }> = ({ headings = [], currentPage }) => {\n  const toc = useRef<any>();\n  const onThisPageID = 'on-this-page-heading';\n  const itemOffsets = useRef<ItemOffsets[]>([]);\n  const [currentID, setCurrentID] = useState('overview');\n  useEffect(() => {\n    const getItemOffsets = () => {\n      const titles = document.querySelectorAll('article :is(h1, h2, h3, h4)');\n      itemOffsets.current = Array.from(titles).map((title) => ({\n        id: title.id,\n        topOffset: title.getBoundingClientRect().top + window.scrollY,\n      }));\n    };\n\n    getItemOffsets();\n    window.addEventListener('resize', getItemOffsets);\n\n    return () => {\n      window.removeEventListener('resize', getItemOffsets);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!toc.current) return;\n\n    const setCurrent: IntersectionObserverCallback = (entries) => {\n      for (const entry of entries) {\n        if (entry.isIntersecting) {\n          const { id } = entry.target;\n          if (id === onThisPageID) continue;\n          setCurrentID(entry.target.id);\n          break;\n        }\n      }\n    };\n\n    const observerOptions: IntersectionObserverInit = {\n      // Negative top margin accounts for `scroll-margin`.\n      // Negative bottom margin means heading needs to be towards top of viewport to trigger intersection.\n      rootMargin: '-100px 0% -66%',\n      threshold: 1,\n    };\n\n    const headingsObserver = new IntersectionObserver(setCurrent, observerOptions);\n\n    // Observe all the headings in the main page content.\n    document.querySelectorAll('article :is(h1,h2,h3)').forEach((h) => headingsObserver.observe(h));\n\n    // Stop observing when the component is unmounted.\n    return () => headingsObserver.disconnect();\n  }, [toc.current]);\n\n  const onLinkClick = (e: any) => {\n    setCurrentID(e.target.getAttribute('href').replace('#', ''));\n  };\n  const minDepth = 1;\n\n  return (\n    <>\n      <ul ref={toc}>\n        {headings\n          .filter(({ depth }) => depth >= minDepth && depth < 4)\n          .map((heading, i) => (\n            <li className={`w-full`} key={i}>\n              <a\n                href={`${currentPage}/#${heading.slug}`}\n                onClick={onLinkClick}\n                className={`py-0.5 block cursor-pointer w-full border-l-4 border-lineHighlight hover:bg-lineHighlight ${\n                  ['pl-4', 'pl-9', 'pl-12'][heading.depth - minDepth]\n                } ${currentID === heading.slug ? 'bg-lineHighlight' : ''}`.trim()}\n              >\n                {unescape(heading.text)}\n              </a>\n            </li>\n          ))}\n      </ul>\n    </>\n  );\n};\n\nexport default TableOfContents;\n"],"names":["replace","es","unes","cape","m","unescape","un","TableOfContents","headings","currentPage","toc","useRef","onThisPageID","itemOffsets","currentID","setCurrentID","useState","useEffect","getItemOffsets","titles","title","setCurrent","entries","entry","id","observerOptions","headingsObserver","h","onLinkClick","minDepth","jsx","Fragment","depth","heading","i"],"mappings":"6HAsBA,KAAM,CAAC,QAAAA,CAAO,EAAI,GAGZC,EAAK,iDAuBLC,EAAO,CACX,QAAS,IACT,QAAS,IACT,OAAQ,IACR,QAAS,IACT,OAAQ,IACR,QAAS,IACT,SAAU,IACV,QAAS,IACT,SAAU,IACV,QAAS,GACX,EACMC,EAAOC,GAAKF,EAAKE,CAAC,EAUXC,EAAWC,GAAMN,EAAQ,KAAKM,EAAIL,EAAIE,CAAI,EC5DjDI,EAA4E,CAAC,CAAE,SAAAC,EAAW,CAAC,EAAG,YAAAC,KAAkB,CACpH,MAAMC,EAAMC,EAAAA,SACNC,EAAe,uBACfC,EAAcF,SAAsB,CAAA,CAAE,EACtC,CAACG,EAAWC,CAAY,EAAIC,WAAS,UAAU,EACrDC,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAiB,IAAM,CACrB,MAAAC,EAAS,SAAS,iBAAiB,6BAA6B,EACtEN,EAAY,QAAU,MAAM,KAAKM,CAAM,EAAE,IAAKC,IAAW,CACvD,GAAIA,EAAM,GACV,UAAWA,EAAM,sBAAsB,EAAE,IAAM,OAAO,OACtD,EAAA,CAAA,EAGW,OAAAF,IACR,OAAA,iBAAiB,SAAUA,CAAc,EAEzC,IAAM,CACJ,OAAA,oBAAoB,SAAUA,CAAc,CAAA,CAEvD,EAAG,CAAE,CAAA,EAELD,EAAAA,UAAU,IAAM,CACV,GAAA,CAACP,EAAI,QAAS,OAEZ,MAAAW,EAA4CC,GAAY,CAC5D,UAAWC,KAASD,EAClB,GAAIC,EAAM,eAAgB,CAClB,KAAA,CAAE,GAAAC,CAAG,EAAID,EAAM,OACrB,GAAIC,IAAOZ,EAAc,SACZG,EAAAQ,EAAM,OAAO,EAAE,EAC5B,KACF,CACF,EAGIE,EAA4C,CAGhD,WAAY,iBACZ,UAAW,CAAA,EAGPC,EAAmB,IAAI,qBAAqBL,EAAYI,CAAe,EAGpE,gBAAA,iBAAiB,uBAAuB,EAAE,QAASE,GAAMD,EAAiB,QAAQC,CAAC,CAAC,EAGtF,IAAMD,EAAiB,YAAW,EACxC,CAAChB,EAAI,OAAO,CAAC,EAEV,MAAAkB,EAAe,GAAW,CACjBb,EAAA,EAAE,OAAO,aAAa,MAAM,EAAE,QAAQ,IAAK,EAAE,CAAC,CAAA,EAEvDc,EAAW,EAGf,OAAAC,EAAA,IAAAC,EAAA,SAAA,CACE,eAAC,KAAG,CAAA,IAAKrB,EACN,SACEF,EAAA,OAAO,CAAC,CAAE,MAAAwB,CAAM,IAAMA,GAASH,GAAYG,EAAQ,CAAC,EACpD,IAAI,CAACC,EAASC,IACbJ,EAAAA,IAAC,KAAG,CAAA,UAAW,SACb,SAAAA,EAAA,IAAC,IAAA,CACC,KAAM,GAAGrB,CAAW,KAAKwB,EAAQ,IAAI,GACrC,QAASL,EACT,UAAW,6FACT,CAAC,OAAQ,OAAQ,OAAO,EAAEK,EAAQ,MAAQJ,CAAQ,CACpD,IAAIf,IAAcmB,EAAQ,KAAO,mBAAqB,EAAE,GAAG,KAAK,EAE/D,SAAA5B,EAAS4B,EAAQ,IAAI,CAAA,CARI,CAAA,EAAAC,CAU9B,CACD,CACL,CAAA,CACF,CAAA,CAEJ","x_google_ignoreList":[0]}