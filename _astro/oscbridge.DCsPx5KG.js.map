{"version":3,"file":"oscbridge.DCsPx5KG.js","sources":["../../../packages/desktopbridge/oscbridge.mjs"],"sourcesContent":["import { Pattern, ClockCollator } from '@strudel/core';\nimport { parseControlsFromHap } from 'node_modules/@strudel/osc/osc.mjs';\nimport { Invoke } from './utils.mjs';\n\nconst collator = new ClockCollator({});\n\nexport async function oscTriggerTauri(t_deprecate, hap, currentTime, cps = 1, targetTime) {\n  const controls = parseControlsFromHap(hap, cps);\n  const params = [];\n  const timestamp = collator.calculateTimestamp(currentTime, targetTime);\n\n  Object.keys(controls).forEach((key) => {\n    const val = controls[key];\n    const value = typeof val === 'number' ? val.toString() : val;\n\n    if (value == null) {\n      return;\n    }\n    params.push({\n      name: key,\n      value,\n      valueisnumber: typeof val === 'number',\n    });\n  });\n\n  if (params.length === 0) {\n    return;\n  }\n  const message = { target: '/dirt/play', timestamp, params };\n  setTimeout(() => {\n    Invoke('sendosc', { messagesfromjs: [message] });\n  });\n}\nPattern.prototype.osc = function () {\n  return this.onTrigger(oscTriggerTauri);\n};\n"],"names":["collator","ClockCollator","oscTriggerTauri","t_deprecate","hap","currentTime","cps","targetTime","controls","parseControlsFromHap","params","timestamp","key","val","value","message","Invoke","Pattern"],"mappings":"+WAIA,MAAMA,EAAW,IAAIC,EAAc,CAAA,CAAE,EAE9B,eAAeC,EAAgBC,EAAaC,EAAKC,EAAaC,EAAM,EAAGC,EAAY,CACxF,MAAMC,EAAWC,EAAqBL,EAAKE,CAAG,EACxCI,EAAS,CAAA,EACTC,EAAYX,EAAS,mBAAmBK,EAAaE,CAAU,EAgBrE,GAdA,OAAO,KAAKC,CAAQ,EAAE,QAASI,GAAQ,CACrC,MAAMC,EAAML,EAASI,CAAG,EAClBE,EAAQ,OAAOD,GAAQ,SAAWA,EAAI,SAAU,EAAGA,EAErDC,GAAS,MAGbJ,EAAO,KAAK,CACV,KAAME,EACN,MAAAE,EACA,cAAe,OAAOD,GAAQ,QACpC,CAAK,CACL,CAAG,EAEGH,EAAO,SAAW,EACpB,OAEF,MAAMK,EAAU,CAAE,OAAQ,aAAc,UAAAJ,EAAW,OAAAD,CAAM,EACzD,WAAW,IAAM,CACfM,EAAO,UAAW,CAAE,eAAgB,CAACD,CAAO,CAAG,CAAA,CACnD,CAAG,CACH,CACAE,EAAQ,UAAU,IAAM,UAAY,CAClC,OAAO,KAAK,UAAUf,CAAe,CACvC"}