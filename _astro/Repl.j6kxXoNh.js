import{j as e}from"./jsx-runtime.DDS51bD4.js";import{C as U,g as ie,T as be,a5 as je}from"./index.D4gUoMKi.js";import{c as w,B as K,a as ye}from"./PatternsTab.qfsplO7z.js";import{j as Ee,a as Ce,S as ke,t as Te,d as V}from"./preload-helper.DvoWeRdl.js";import{s as Ne,g as z,e as Se,i as Re,w as Ie,f as Ae,h as Me}from"./scope.xTLPf_3p.js";import{g as M,r as _e,v as Pe,w as Fe,x as Le,y as Oe,z as le,A as ce,s as x,B as De,C as Be,D as X,E as $e,u as de,F as He,q as Ze,G as q,o as Ue,n as ue,H as Ke,I as ze,j as F,J as L,K as We,L as J,M as Ge,N as Y,O as Ve,R as Xe,P as qe}from"./useClient.DiQ_SDfS.js";import{clearHydra as Q}from"./hydra.30TBJVQK.js";import{r as o,R as Je}from"./index.DIn8BZQ7.js";/* empty css                      */import{u as he}from"./useEvent.DKA6syeh.js";import"./_commonjsHelpers.BosuxZz1.js";function Ye({title:t,titleId:n,...s},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?o.createElement("title",{id:n},t):null,o.createElement("path",{fillRule:"evenodd",d:"M9.664 1.319a.75.75 0 0 1 .672 0 41.059 41.059 0 0 1 8.198 5.424.75.75 0 0 1-.254 1.285 31.372 31.372 0 0 0-7.86 3.83.75.75 0 0 1-.84 0 31.508 31.508 0 0 0-2.08-1.287V9.394c0-.244.116-.463.302-.592a35.504 35.504 0 0 1 3.305-2.033.75.75 0 0 0-.714-1.319 37 37 0 0 0-3.446 2.12A2.216 2.216 0 0 0 6 9.393v.38a31.293 31.293 0 0 0-4.28-1.746.75.75 0 0 1-.254-1.285 41.059 41.059 0 0 1 8.198-5.424ZM6 11.459a29.848 29.848 0 0 0-2.455-1.158 41.029 41.029 0 0 0-.39 3.114.75.75 0 0 0 .419.74c.528.256 1.046.53 1.554.82-.21.324-.455.63-.739.914a.75.75 0 1 0 1.06 1.06c.37-.369.69-.77.96-1.193a26.61 26.61 0 0 1 3.095 2.348.75.75 0 0 0 .992 0 26.547 26.547 0 0 1 5.93-3.95.75.75 0 0 0 .42-.739 41.053 41.053 0 0 0-.39-3.114 29.925 29.925 0 0 0-5.199 2.801 2.25 2.25 0 0 1-2.514 0c-.41-.275-.826-.541-1.25-.797a6.985 6.985 0 0 1-1.084 3.45 26.503 26.503 0 0 0-1.281-.78A5.487 5.487 0 0 0 6 12v-.54Z",clipRule:"evenodd"}))}const Qe=o.forwardRef(Ye),et=Qe;function tt({title:t,titleId:n,...s},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?o.createElement("title",{id:n},t):null,o.createElement("path",{fillRule:"evenodd",d:"M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z",clipRule:"evenodd"}))}const nt=o.forwardRef(tt),st=nt;function at({title:t,titleId:n,...s},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?o.createElement("title",{id:n},t):null,o.createElement("path",{d:"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}),o.createElement("path",{d:"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}))}const rt=o.forwardRef(at),ot=rt;function it({title:t,titleId:n,...s},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?o.createElement("title",{id:n},t):null,o.createElement("path",{fillRule:"evenodd",d:"M2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm6.39-2.908a.75.75 0 0 1 .766.027l3.5 2.25a.75.75 0 0 1 0 1.262l-3.5 2.25A.75.75 0 0 1 8 12.25v-4.5a.75.75 0 0 1 .39-.658Z",clipRule:"evenodd"}))}const lt=o.forwardRef(it),me=lt;function ct({title:t,titleId:n,...s},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?o.createElement("title",{id:n},t):null,o.createElement("path",{d:"M15.98 1.804a1 1 0 0 0-1.96 0l-.24 1.192a1 1 0 0 1-.784.785l-1.192.238a1 1 0 0 0 0 1.962l1.192.238a1 1 0 0 1 .785.785l.238 1.192a1 1 0 0 0 1.962 0l.238-1.192a1 1 0 0 1 .785-.785l1.192-.238a1 1 0 0 0 0-1.962l-1.192-.238a1 1 0 0 1-.785-.785l-.238-1.192ZM6.949 5.684a1 1 0 0 0-1.898 0l-.683 2.051a1 1 0 0 1-.633.633l-2.051.683a1 1 0 0 0 0 1.898l2.051.684a1 1 0 0 1 .633.632l.683 2.051a1 1 0 0 0 1.898 0l.683-2.051a1 1 0 0 1 .633-.633l2.051-.683a1 1 0 0 0 0-1.898l-2.051-.683a1 1 0 0 1-.633-.633L6.95 5.684ZM13.949 13.684a1 1 0 0 0-1.898 0l-.184.551a1 1 0 0 1-.632.633l-.551.183a1 1 0 0 0 0 1.898l.551.183a1 1 0 0 1 .633.633l.183.551a1 1 0 0 0 1.898 0l.184-.551a1 1 0 0 1 .632-.633l.551-.183a1 1 0 0 0 0-1.898l-.551-.184a1 1 0 0 1-.633-.632l-.183-.551Z"}))}const dt=o.forwardRef(ct),ut=dt;function ht({title:t,titleId:n,...s},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?o.createElement("title",{id:n},t):null,o.createElement("path",{fillRule:"evenodd",d:"M2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm5-2.25A.75.75 0 0 1 7.75 7h4.5a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-4.5Z",clipRule:"evenodd"}))}const mt=o.forwardRef(ht),pt=mt,{BASE_URL:H}={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://strudel.cc/",ASSETS_PREFIX:void 0},ft=H.endsWith("/")?H.slice(0,-1):H;function gt({context:t}){const{embedded:n,started:s,pending:r,isDirty:a,activeCode:u,handleTogglePlay:f,handleEvaluate:l,handleShuffle:g,handleShare:c}=t,i=typeof window<"u"&&(n||window.location!==window.parent.location),{isZen:h}=M();return e.jsxs("header",{id:"header",className:w("flex-none text-black  z-[100] text-lg select-none",!h&&!i&&"bg-lineHighlight",h?"h-12 w-8 fixed top-0 left-0":"sticky top-0 w-full py-1 justify-between",i?"flex":"md:flex"),children:[e.jsx("div",{className:"px-4 flex space-x-2 md:pt-0 select-none",children:e.jsxs("h1",{onClick:()=>{i&&window.open(window.location.href.replace("embed",""))},className:w(i?"text-l cursor-pointer":"text-xl","text-foreground font-bold flex space-x-2 items-center"),children:[e.jsx("div",{className:w("mt-[1px]",s&&"animate-spin","cursor-pointer"),onClick:()=>{i||_e(!h)},children:"üåÄ"}),!h&&e.jsxs("div",{className:w(s&&"animate-pulse"),children:[e.jsx("span",{className:"",children:"strudel"})," ",e.jsx("span",{className:"text-sm",children:"REPL"})]})]})}),!h&&e.jsxs("div",{className:"flex max-w-full overflow-auto text-foreground",children:[e.jsx("button",{onClick:f,title:s?"stop":"play",className:w(i?"px-2":"p-2","hover:opacity-50",!s&&"animate-pulse"),children:r?e.jsx(e.Fragment,{children:"loading..."}):e.jsxs("span",{className:w("flex items-center space-x-1",i?"":"w-16"),children:[s?e.jsx(pt,{className:"w-6 h-6"}):e.jsx(me,{className:"w-6 h-6"}),!i&&e.jsx("span",{children:s?"stop":"play"})]})}),e.jsxs("button",{onClick:l,title:"update",className:w("flex items-center space-x-1",i?"px-2":"p-2",!a||!u?"opacity-50":"hover:opacity-50"),children:[e.jsx(st,{className:"w-6 h-6"}),!i&&e.jsx("span",{children:"update"})]}),!i&&e.jsxs("button",{title:"shuffle",className:"hover:opacity-50 p-2 flex items-center space-x-1",onClick:g,children:[e.jsx(ut,{className:"w-6 h-6"}),e.jsx("span",{children:" shuffle"})]}),!i&&e.jsxs("button",{title:"share",className:w("cursor-pointer hover:opacity-50 flex items-center space-x-1",i?"px-2":"p-2"),onClick:c,children:[e.jsx(ot,{className:"w-6 h-6"}),e.jsx("span",{children:"share"})]}),!i&&e.jsxs("a",{title:"learn",href:`${ft}/workshop/getting-started/`,className:w("hover:opacity-50 flex items-center space-x-1",i?"px-2":"p-2"),children:[e.jsx(et,{className:"w-6 h-6"}),e.jsx("span",{children:"learn"})]})]})]})}function xt({active:t}){return e.jsx("div",{className:"overflow-hidden opacity-50 fixed top-0 left-0 w-full z-[1000]",children:e.jsx("div",{className:w("h-[2px] block w-full",t?"bg-foreground animate-train":"bg-transparent"),children:e.jsx("div",{})})})}function wt({title:t,titleId:n,...s},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?o.createElement("title",{id:n},t):null,o.createElement("path",{d:"M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"}))}const vt=o.forwardRef(wt),bt=vt;function jt({log:t}){return e.jsxs("div",{id:"console-tab",className:"break-all px-4 dark:text-white text-stone-900 text-sm",children:[e.jsx("pre",{children:`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó     
‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë     
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë     
‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  ‚ñà‚ñà‚ïë     
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù   ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù`}),t.map((n,s)=>{const r=yt(n.message);return e.jsxs("div",{className:w(n.type==="error"&&"text-red-500",n.type==="highlight"&&"underline"),children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:r}}),n.count?` (${n.count})`:""]},n.id)})]})}function yt(t){var n,s,r,a;return s=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,n=t.replace(s,'<a class="underline" href="$1" target="_blank">$1</a>'),r=/(^|[^\/])(www\.[\S]+(\b|$))/gim,n=n.replace(r,'$1<a class="underline" href="http://$2" target="_blank">$2</a>'),a=/(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim,n=n.replace(a,'<a class="underline" href="mailto:$1">$1</a>'),n}function Et(){const[t,n]=o.useState([]);o.useEffect(()=>(Pe("",{dir:Fe,recursive:!0}).then(l=>n([{name:"~/music",children:l}])).catch(l=>{console.log("error loadin files",l)}),()=>{}),[]);const s=o.useMemo(()=>t[t.length-1],[t]),r=o.useMemo(()=>t.slice(1).map(l=>l.name).join("/"),[t]),a=o.useMemo(()=>s?.children.filter(l=>!!l.children),[s]),u=o.useMemo(()=>s?.children.filter(l=>!l.children&&Le(l.name)),[s]),f=l=>n(g=>g.concat([l]));return e.jsxs("div",{className:"px-4 flex flex-col h-full",children:[e.jsx("div",{className:"flex justify-between font-mono pb-1",children:e.jsxs("div",{children:[e.jsx("span",{children:"samples('"}),t?.map((l,g)=>g<t.length-1?e.jsxs(o.Fragment,{children:[e.jsx("span",{className:"cursor-pointer underline",onClick:()=>n(c=>c.slice(0,g+1)),children:l.name}),e.jsx("span",{children:"/"})]},g):e.jsx("span",{className:"cursor-pointer underline",children:l.name},g)),e.jsx("span",{children:"')"})]})}),e.jsxs("div",{className:"overflow-auto",children:[!a?.length&&!u?.length&&e.jsx("span",{className:"text-gray-500",children:"Nothing here"}),a?.map((l,g)=>e.jsx("div",{className:"cursor-pointer",onClick:()=>f(l),children:l.name},g)),u?.map((l,g)=>e.jsx("div",{className:"text-gray-500 cursor-pointer select-none",onClick:async()=>Oe(`${r}/${l.name}`),children:l.name},g))]})]})}const ee=Ee.docs.filter(({name:t,description:n})=>t&&!t.startsWith("_")&&!!n).sort((t,n)=>t.name.localeCompare(n.name)),Ct=t=>{var n=document.createElement("div");return n.innerHTML=t,n.textContent||n.innerText||""};function kt(){return e.jsxs("div",{className:"flex h-full w-full pt-2 text-foreground overflow-hidden",children:[e.jsx("div",{className:"w-42 flex-none h-full overflow-y-auto overflow-x-hidden pr-4",children:ee.map((t,n)=>e.jsxs("a",{className:"cursor-pointer block hover:bg-lineHighlight py-1 px-4",onClick:()=>{const s=document.getElementById(`doc-${n}`);document.getElementById("reference-container").scrollTo(0,s.offsetTop)},children:[t.name," "]},n))}),e.jsx("div",{className:"break-normal w-full h-full overflow-auto pl-4 flex relative",id:"reference-container",children:e.jsxs("div",{className:"prose dark:prose-invert max-w-full pr-4",children:[e.jsx("h2",{children:"API Reference"}),e.jsx("p",{children:"This is the long list functions you can use! Remember that you don't need to remember all of those and that you can already make music with a small set of functions!"}),ee.map((t,n)=>e.jsxs("section",{children:[e.jsx("h3",{id:`doc-${n}`,children:t.name}),!!t.synonyms_text&&e.jsxs("p",{children:["Synonyms: ",e.jsx("code",{children:t.synonyms_text})]}),e.jsx("p",{dangerouslySetInnerHTML:{__html:t.description}}),e.jsx("ul",{children:t.params?.map(({name:s,type:r,description:a},u)=>e.jsxs("li",{children:[s," : ",r.names?.join(" | ")," ",a?e.jsxs(e.Fragment,{children:[" - ",Ct(a)]}):""]},u))}),t.examples?.map((s,r)=>e.jsx("pre",{children:s},r))]},n))]})})]})}function Tt({value:t,options:n,onChange:s,onClick:r,isDisabled:a}){return e.jsxs("select",{disabled:a,onClick:r,className:"p-2 bg-background rounded-md text-foreground",value:t??"",onChange:u=>s(u.target.value),children:[n.size==0&&e.jsx("option",{value:t,children:`${t??"select an option"}`}),Array.from(n.keys()).map(u=>e.jsx("option",{className:"bg-background",value:u,children:n.get(u)},u))]})}const Nt=new Map;function St({audioDeviceName:t,onChange:n,isDisabled:s}){const[r,a]=o.useState(Nt),u=r.size>0,f=()=>{u||le().then(c=>{a(c)})},l=c=>{if(!u)return;const i=r.get(c);n(c),ce(i)},g=new Map;return Array.from(r.keys()).forEach(c=>{g.set(c,c)}),e.jsx(Tt,{isDisabled:s,options:g,onClick:f,value:t,onChange:l})}function y({label:t,value:n,onChange:s}){return e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:n,onChange:s})," "+t]})}function te({value:t,options:n,onChange:s}){return e.jsx("select",{className:"p-2 bg-background rounded-md text-foreground",value:t,onChange:r=>s(r.target.value),children:Object.entries(n).map(([r,a])=>e.jsx("option",{className:"bg-background",value:r,children:a},r))})}function Rt({value:t,onChange:n,step:s=1,...r}){return e.jsxs("div",{className:"flex space-x-2 gap-1",children:[e.jsx("input",{className:"p-2 grow",type:"range",value:t,step:s,onChange:a=>n(Number(a.target.value)),...r}),e.jsx("input",{type:"number",value:t,step:s,className:"w-16 bg-background rounded-md",onChange:a=>n(Number(a.target.value))})]})}function k({label:t,children:n}){return e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{children:t}),n]})}const It=Object.fromEntries(Object.keys(Ce).map(t=>[t,t])),At={monospace:"monospace",Courier:"Courier",JetBrains:"JetBrains",Hack:"Hack",FiraCode:"FiraCode","FiraCode-SemiBold":"FiraCode SemiBold",teletext:"teletext",mode7:"mode7",BigBlueTerminal:"BigBlueTerminal",x3270:"x3270",Monocraft:"Monocraft",PressStart:"PressStart2P","we-come-in-peace":"we-come-in-peace",galactico:"galactico"};function Mt({started:t}){const{theme:n,keybindings:s,isBracketClosingEnabled:r,isBracketMatchingEnabled:a,isLineNumbersDisplayed:u,isPatternHighlightingEnabled:f,isActiveLineHighlighted:l,isAutoCompletionEnabled:g,isTooltipEnabled:c,isFlashEnabled:i,isSyncEnabled:h,isLineWrappingEnabled:p,fontSize:m,fontFamily:E,panelPosition:v,audioDeviceName:T}=M();return e.jsxs("div",{className:"text-foreground p-4 space-y-4",children:[AudioContext.prototype.setSinkId!=null&&e.jsx(k,{label:"Audio Output Device",children:e.jsx(St,{isDisabled:t,audioDeviceName:T,onChange:d=>x.setKey("audioDeviceName",d)})}),e.jsx(k,{label:"Theme",children:e.jsx(te,{options:It,value:n,onChange:d=>x.setKey("theme",d)})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(k,{label:"Font Family",children:e.jsx(te,{options:At,value:E,onChange:d=>x.setKey("fontFamily",d)})}),e.jsx(k,{label:"Font Size",children:e.jsx(Rt,{value:m,onChange:d=>x.setKey("fontSize",d),min:10,max:40,step:2})})]}),e.jsx(k,{label:"Keybindings",children:e.jsx(K,{value:s,onChange:d=>x.setKey("keybindings",d),items:{codemirror:"Codemirror",vim:"Vim",emacs:"Emacs",vscode:"VSCode"}})}),e.jsx(k,{label:"Panel Position",children:e.jsx(K,{value:v,onChange:d=>x.setKey("panelPosition",d),items:{bottom:"Bottom",right:"Right"}})}),e.jsxs(k,{label:"Code Settings",children:[e.jsx(y,{label:"Enable bracket matching",onChange:d=>x.setKey("isBracketMatchingEnabled",d.target.checked),value:a}),e.jsx(y,{label:"Auto close brackets",onChange:d=>x.setKey("isBracketClosingEnabled",d.target.checked),value:r}),e.jsx(y,{label:"Display line numbers",onChange:d=>x.setKey("isLineNumbersDisplayed",d.target.checked),value:u}),e.jsx(y,{label:"Highlight active line",onChange:d=>x.setKey("isActiveLineHighlighted",d.target.checked),value:l}),e.jsx(y,{label:"Highlight events in code",onChange:d=>x.setKey("isPatternHighlightingEnabled",d.target.checked),value:f}),e.jsx(y,{label:"Enable auto-completion",onChange:d=>x.setKey("isAutoCompletionEnabled",d.target.checked),value:g}),e.jsx(y,{label:"Enable tooltips on Ctrl and hover",onChange:d=>x.setKey("isTooltipEnabled",d.target.checked),value:c}),e.jsx(y,{label:"Enable line wrapping",onChange:d=>x.setKey("isLineWrappingEnabled",d.target.checked),value:p}),e.jsx(y,{label:"Enable flashing on evaluation",onChange:d=>x.setKey("isFlashEnabled",d.target.checked),value:i}),e.jsx(y,{label:"Sync across Browser Tabs / Windows",onChange:d=>{confirm("Changing this setting requires the window to reload itself. OK?")&&(x.setKey("isSyncEnabled",d.target.checked),window.location.reload())},value:h})]}),e.jsx(k,{label:"Zen Mode",children:"Try clicking the logo in the top left!"}),e.jsx(k,{label:"Reset Settings",children:e.jsx("button",{className:"bg-background p-2 max-w-[300px] rounded-md hover:opacity-50",onClick:()=>{confirm("Sure?")&&x.set(De)},children:"restore default settings"})})]})}function _t({onComplete:t}){let n=Je.createRef();const[s,r]=o.useState(!1),a=o.useCallback(async()=>{n.current.files?.length&&(r(!0),await Be(X,n.current.files).then(()=>{$e(X,()=>{t(),r(!1)})}))});return e.jsxs("label",{style:{alignItems:"center"},className:"flex bg-background ml-2 pl-2 pr-2 max-w-[300px] rounded-md hover:opacity-50 whitespace-nowrap cursor-pointer",children:[e.jsx("input",{disabled:s,ref:n,id:"audio_file",style:{display:"none"},type:"file",directory:"",webkitdirectory:"",multiple:!0,accept:"audio/*",onChange:()=>{a()}}),s?"importing...":"import sounds"]})}const Pt=t=>Array.isArray(t)?t.length:typeof t=="object"?Object.values(t).length:1;function Ft(){const t=de(Ne),{soundsFilter:n}=M(),s=o.useMemo(()=>{let a=Object.entries(t).filter(([u])=>!u.startsWith("_"));return t?n==="user"?a.filter(([u,{data:f}])=>!f.prebake):n==="drums"?a.filter(([u,{data:f}])=>f.type==="sample"&&f.tag==="drum-machines"):n==="samples"?a.filter(([u,{data:f}])=>f.type==="sample"&&f.tag!=="drum-machines"):n==="synths"?a.filter(([u,{data:f}])=>["synth","soundfont"].includes(f.type)):a:[]},[t,n]),r=o.useRef();return he("mouseup",()=>{const a=r.current;r.current=void 0,a?.then(u=>{u?.stop(z().currentTime+.01)})}),e.jsxs("div",{id:"sounds-tab",className:"px-4 flex flex-col w-full h-full dark:text-white text-stone-900",children:[e.jsxs("div",{className:"pb-2 flex shrink-0 overflow-auto",children:[e.jsx(K,{value:n,onChange:a=>x.setKey("soundsFilter",a),items:{samples:"samples",drums:"drum-machines",synths:"Synths",user:"User"}}),e.jsx(_t,{onComplete:()=>x.setKey("soundsFilter","user")})]}),e.jsxs("div",{className:"min-h-0 max-h-full grow overflow-auto font-mono text-sm break-normal",children:[s.map(([a,{data:u,onTrigger:f}])=>e.jsxs("span",{className:"cursor-pointer hover:opacity-50",onMouseDown:async()=>{const l=z(),g={note:["synth","soundfont"].includes(u.type)?"a3":void 0,s:a,clip:1,release:.5,sustain:1,duration:.5},c=l.currentTime+.05,i=()=>r.current?.node?.disconnect();r.current=Promise.resolve(f(c,g,i)),r.current.then(h=>{Se(h?.node)})},children:[" ",a,u?.type==="sample"?`(${Pt(u.samples)})`:"",u?.type==="soundfont"?`(${u.fonts.length})`:""]},a)),s.length?"":"No custom sounds loaded in this pattern (yet)."]})]})}const{BASE_URL:Z}={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://strudel.cc/",ASSETS_PREFIX:void 0},Lt=Z.endsWith("/")?Z.slice(0,-1):Z;function Ot({context:t}){return e.jsxs("div",{className:"prose dark:prose-invert max-w-[600px] pt-2 font-sans pb-8 px-4",children:[e.jsxs("h3",{children:[e.jsx("span",{className:w("animate-spin inline-block select-none"),children:"üåÄ"})," welcome"]}),e.jsxs("p",{children:["You have found ",e.jsx("span",{className:"underline",children:"strudel"}),", a new live coding platform to write dynamic music pieces in the browser! It is free and open-source and made for beginners and experts alike. To get started:",e.jsx("br",{}),e.jsx("br",{}),e.jsx("span",{className:"underline",children:"1. hit play"})," - ",e.jsx("span",{className:"underline",children:"2. change something"})," -"," ",e.jsx("span",{className:"underline",children:"3. hit update"}),e.jsx("br",{}),"If you don't like what you hear, try ",e.jsx("span",{className:"underline",children:"shuffle"}),"!"]}),e.jsxs("p",{children:["To learn more about what this all means, check out the"," ",e.jsx("a",{href:`${Lt}/workshop/getting-started/`,target:"_blank",children:"interactive tutorial"}),". Also feel free to join the"," ",e.jsx("a",{href:"https://discord.com/invite/HGEdXmRkzT",target:"_blank",children:"tidalcycles discord channel"})," ","to ask any questions, give feedback or just say hello."]}),e.jsx("h3",{children:"about"}),e.jsxs("p",{children:["strudel is a JavaScript version of"," ",e.jsx("a",{href:"https://tidalcycles.org/",target:"_blank",children:"tidalcycles"}),", which is a popular live coding language for music, written in Haskell. Strudel is free/open source software: you can redistribute and/or modify it under the terms of the"," ",e.jsx("a",{href:"https://github.com/tidalcycles/strudel/blob/main/LICENSE",target:"_blank",children:"GNU Affero General Public License"}),". You can find the source code at"," ",e.jsx("a",{href:"https://github.com/tidalcycles/strudel",target:"_blank",children:"github"}),". Please consider to"," ",e.jsx("a",{href:"https://opencollective.com/tidalcycles",target:"_blank",children:"support this project"})," ","to ensure ongoing development üíñ"]})]})}const ne=typeof window<"u"?o.useLayoutEffect:o.useEffect,Dt=typeof window<"u"&&window.__TAURI__;function se({context:t}){const n=o.useRef(),[s,r]=o.useState([]),{activeFooter:a,isZen:u,panelPosition:f}=M();ne(()=>{n.current&&a==="console"&&(n.current.scrollTop=n.current?.scrollHeight)},[s,a]),ne(()=>{n.current&&(a==="console"?n.current.scrollTop=n.current?.scrollHeight:n.current.scrollTop=0)},[a]),Bt(o.useCallback(h=>{const{message:p,type:m,data:E}=h.detail;r(v=>{const T=v.length?v[v.length-1]:void 0,d=He(12);if(m==="loaded-sample"){const $=v.findIndex(({data:{url:_},type:W})=>W==="load-sample"&&_===E.url);v[$]={message:p,type:m,id:d,data:E}}else T&&T.message===p?v=v.slice(0,-1).concat([{message:p,type:m,count:(T.count??1)+1,id:d,data:E}]):v=v.concat([{message:p,type:m,id:d,data:E}]);return v.slice(-20)})},[]));const l=({children:h,name:p,label:m})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:()=>q(p),className:w("h-8 px-2 text-foreground cursor-pointer hover:opacity-50 flex items-center space-x-1 border-b",a===p?"border-foreground":"border-transparent"),children:m||p}),a===p&&e.jsx(e.Fragment,{children:h})]}),g=Ze();if(u)return null;const c=a!=="";let i={right:w("max-w-full flex-grow-0 flex-none overflow-hidden",c?"w-[600px] h-full":"absolute right-0"),bottom:w("relative",c?"h-[360px] min-h-[360px]":"")};return g?e.jsxs("nav",{className:w("bg-lineHighlight z-[10] flex flex-col",i[f]),children:[e.jsxs("div",{className:"flex justify-between px-2",children:[e.jsxs("div",{className:w("flex select-none max-w-full overflow-auto",a&&"pb-2"),children:[e.jsx(l,{name:"intro",label:"welcome"}),e.jsx(l,{name:"patterns"}),e.jsx(l,{name:"sounds"}),e.jsx(l,{name:"console"}),e.jsx(l,{name:"reference"}),e.jsx(l,{name:"settings"}),Dt&&e.jsx(l,{name:"files"})]}),a!==""&&e.jsx("button",{onClick:()=>q(""),className:"text-foreground px-2","aria-label":"Close Panel",children:e.jsx(bt,{className:"w-5 h-5"})})]}),a!==""&&e.jsx("div",{className:"relative overflow-hidden",children:e.jsxs("div",{className:"text-white overflow-auto h-full max-w-full",ref:n,children:[a==="intro"&&e.jsx(Ot,{context:t}),a==="patterns"&&e.jsx(ye,{context:t}),a==="console"&&e.jsx(jt,{log:s}),a==="sounds"&&e.jsx(Ft,{}),a==="reference"&&e.jsx(kt,{}),a==="settings"&&e.jsx(Mt,{started:t.started}),a==="files"&&e.jsx(Et,{})]})})]}):null}function Bt(t){he(U.key,t)}const $t=t=>(n,s)=>(t.set(n,s),s),ae=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,pe=536870912,re=pe*2,Ht=(t,n)=>s=>{const r=n.get(s);let a=r===void 0?s.size:r<re?r+1:0;if(!s.has(a))return t(s,a);if(s.size<pe){for(;s.has(a);)a=Math.floor(Math.random()*re);return t(s,a)}if(s.size>ae)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;s.has(a);)a=Math.floor(Math.random()*ae);return t(s,a)},fe=new WeakMap,Zt=$t(fe),O=Ht(Zt,fe),Ut=t=>t.method!==void 0&&t.method==="call",Kt=t=>t.error===null&&typeof t.id=="number",zt=t=>{const n=new Map([[0,()=>{}]]),s=new Map([[0,()=>{}]]),r=new Map,a=new Worker(t);return a.addEventListener("message",({data:c})=>{if(Ut(c)){const{params:{timerId:i,timerType:h}}=c;if(h==="interval"){const p=n.get(i);if(typeof p=="number"){const m=r.get(p);if(m===void 0||m.timerId!==i||m.timerType!==h)throw new Error("The timer is in an undefined state.")}else if(typeof p<"u")p();else throw new Error("The timer is in an undefined state.")}else if(h==="timeout"){const p=s.get(i);if(typeof p=="number"){const m=r.get(p);if(m===void 0||m.timerId!==i||m.timerType!==h)throw new Error("The timer is in an undefined state.")}else if(typeof p<"u")p(),s.delete(i);else throw new Error("The timer is in an undefined state.")}}else if(Kt(c)){const{id:i}=c,h=r.get(i);if(h===void 0)throw new Error("The timer is in an undefined state.");const{timerId:p,timerType:m}=h;r.delete(i),m==="interval"?n.delete(p):s.delete(p)}else{const{error:{message:i}}=c;throw new Error(i)}}),{clearInterval:c=>{const i=O(r);r.set(i,{timerId:c,timerType:"interval"}),n.set(c,i),a.postMessage({id:i,method:"clear",params:{timerId:c,timerType:"interval"}})},clearTimeout:c=>{const i=O(r);r.set(i,{timerId:c,timerType:"timeout"}),s.set(c,i),a.postMessage({id:i,method:"clear",params:{timerId:c,timerType:"timeout"}})},setInterval:(c,i=0)=>{const h=O(n);return n.set(h,()=>{c(),typeof n.get(h)=="function"&&a.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:h,timerType:"interval"}})}),a.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:h,timerType:"interval"}}),h},setTimeout:(c,i=0)=>{const h=O(s);return s.set(h,c),a.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:h,timerType:"timeout"}}),h}}},Wt=(t,n)=>{let s=null;return()=>{if(s!==null)return s;const r=new Blob([n],{type:"application/javascript; charset=utf-8"}),a=URL.createObjectURL(r);return s=t(a),setTimeout(()=>URL.revokeObjectURL(a)),s}},Gt=`(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error('There is no interval scheduled with the given id "'.concat(t,'".'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error('The given type "'.concat(i,'" is not supported'));(e=>{const r=t.get(e);if(void 0===r)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error('The given method "'.concat(s.method,'" is not supported'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error('The given type "'.concat(d,'" is not supported'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();`,ge=Wt(zt,Gt),Vt=t=>ge().clearInterval(t),Xt=(...t)=>ge().setInterval(...t),{latestCode:oe}=x.get();let B,xe,D,we,ve;typeof window<"u"&&(Re(),B=Ue(),xe=ue(),D=ie(),we=()=>D.clearRect(0,0,D.canvas.height,D.canvas.width),ve=window.location!==window.parent.location);async function qt(t){return B?(await B).find(s=>s.packageName===t):void 0}function hn({embedded:t=!1}){const n=t||ve,{panelPosition:s,isZen:r,isSyncEnabled:a}=M(),u=o.useCallback(()=>{const b=[-2,2],j=ie(),S=new ke({sync:a,defaultOutput:Ie,getTime:()=>z().currentTime,setInterval:Xt,clearInterval:Vt,transpiler:Te,autodraw:!1,root:E.current,initialCode:"// LOADING",pattern:be,drawTime:b,drawContext:j,prebake:async()=>Promise.all([B,xe]),onUpdateState:N=>{l({...N})},onToggle:N=>{N||Q()},afterEval:N=>{const{code:C}=N;Ke(C),window.location.hash="#"+je(C);const I=ze(),A={...I,code:C};let R=A.id;if(I.collection!==F.collection){if(C!==I.code){const G=F.duplicate(A);R=G.id,L(G.data)}}else R=F.isValidID(R)?R:We(),L(F.update(R,A).data);J(R)},bgFill:!1});Ge().then(async N=>{let C;if(N)S.setCode(N),C="I have loaded the code from the URL.";else if(oe)S.setCode(oe),C="Your last session has been loaded!";else{const{code:I,name:A}=await Y();S.setCode(I),C=`A random code snippet named "${A}" has been loaded!`}U(`Welcome to Strudel! ${C} Press play or hit ctrl+enter to run it!`,"highlight")}),m.current=S},[]),[f,l]=o.useState({}),{started:g,isDirty:c,error:i,activeCode:h,pending:p}=f,m=o.useRef(),E=o.useRef(),v=de(x,{keys:Object.keys(V)});o.useEffect(()=>{let b={};Object.keys(V).forEach(j=>{v.hasOwnProperty(j)&&(b[j]=v[j])}),m.current?.updateSettings(b)},[v]),o.useEffect(()=>{const{audioDeviceName:b}=v;b!==Ve&&le().then(j=>{const S=j.get(b);S!=null&&ce(S)})},[]);const T=async()=>{m.current?.toggle()},d=async()=>{(await qt("@strudel/tonal"))?.resetVoicings(),Ae(),we(),Q(),Me(),m.current.repl.setCps(.5),await ue()},$=async(b,j=!1)=>{L(b),m.current.setCode(b.code),j&&(await d(),_())},_=()=>{m.current.evaluate()},P={embedded:t,started:g,pending:p,isDirty:c,activeCode:h,handleTogglePlay:T,handleUpdate:$,handleShuffle:async()=>{const b=await Y(),j=b.code;U(`[repl] ‚ú® loading random tune "${b.id}"`),J(b.id),L(b),await d(),m.current.setCode(j),m.current.repl.evaluate(j)},handleShare:async()=>qe(f.code),handleEvaluate:_};return e.jsx(Xe.Provider,{value:P,children:e.jsxs("div",{className:w("h-full flex flex-col relative"),children:[e.jsx(xt,{active:p}),e.jsx(gt,{context:P}),n&&!g&&e.jsxs("button",{onClick:()=>T(),className:"text-white text-2xl fixed left-[50%] top-[50%] translate-x-[-50%] translate-y-[-50%] z-[1000] m-auto p-4 bg-black rounded-md flex items-center space-x-2",children:[e.jsx(me,{className:"w-6 h-6"}),e.jsx("span",{children:"play"})]}),e.jsxs("div",{className:"grow flex relative overflow-hidden",children:[e.jsx("section",{className:"text-gray-100 cursor-text pb-0 overflow-auto grow"+(r?" px-10":""),id:"code",ref:b=>{E.current=b,m.current||u()}}),s==="right"&&!n&&e.jsx(se,{context:P})]}),i&&e.jsx("div",{className:"text-red-500 p-4 bg-lineHighlight animate-pulse",children:i.message||"Unknown Error :-/"}),s==="bottom"&&!n&&e.jsx(se,{context:P})]})})}export{hn as Repl};
//# sourceMappingURL=Repl.j6kxXoNh.js.map
