{"version":3,"file":"oscbridge_be36ff78.mjs","sources":["../../../packages/desktopbridge/oscbridge.mjs"],"sourcesContent":["import { parseNumeral, Pattern } from '@strudel.cycles/core';\nimport { Invoke } from './utils.mjs';\n\nPattern.prototype.osc = function () {\n  return this.onTrigger(async (time, hap, currentTime, cps = 1) => {\n    hap.ensureObjectValue();\n    const cycle = hap.wholeOrPart().begin.valueOf();\n    const delta = hap.duration.valueOf();\n    const controls = Object.assign({}, { cps, cycle, delta }, hap.value);\n    // make sure n and note are numbers\n    controls.n && (controls.n = parseNumeral(controls.n));\n    controls.note && (controls.note = parseNumeral(controls.note));\n\n    const params = [];\n\n    const timestamp = Math.round(Date.now() + (time - currentTime) * 1000);\n\n    Object.keys(controls).forEach((key) => {\n      const val = controls[key];\n      const value = typeof val === 'number' ? val.toString() : val;\n\n      if (value == null) {\n        return;\n      }\n      params.push({\n        name: key,\n        value,\n        valueisnumber: typeof val === 'number',\n      });\n    });\n\n    const messagesfromjs = [];\n    if (params.length) {\n      messagesfromjs.push({ target: '/dirt/play', timestamp, params });\n    }\n\n    if (messagesfromjs.length) {\n      setTimeout(() => {\n        Invoke('sendosc', { messagesfromjs });\n      });\n    }\n  });\n};\n"],"names":[],"mappings":";;;;;;;;;;AAGA,OAAO,CAAC,SAAS,CAAC,GAAG,GAAG,YAAY;AACpC,EAAE,OAAO,IAAI,CAAC,SAAS,CAAC,OAAO,IAAI,EAAE,GAAG,EAAE,WAAW,EAAE,GAAG,GAAG,CAAC,KAAK;AACnE,IAAI,GAAG,CAAC,iBAAiB,EAAE,CAAC;AAC5B,IAAI,MAAM,KAAK,GAAG,GAAG,CAAC,WAAW,EAAE,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;AACpD,IAAI,MAAM,KAAK,GAAG,GAAG,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC;AACzC,IAAI,MAAM,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC;AACzE;AACA,IAAI,QAAQ,CAAC,CAAC,KAAK,QAAQ,CAAC,CAAC,GAAG,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;AAC1D,IAAI,QAAQ,CAAC,IAAI,KAAK,QAAQ,CAAC,IAAI,GAAG,YAAY,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;AACnE;AACA,IAAI,MAAM,MAAM,GAAG,EAAE,CAAC;AACtB;AACA,IAAI,MAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,GAAG,WAAW,IAAI,IAAI,CAAC,CAAC;AAC3E;AACA,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,KAAK;AAC3C,MAAM,MAAM,GAAG,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC;AAChC,MAAM,MAAM,KAAK,GAAG,OAAO,GAAG,KAAK,QAAQ,GAAG,GAAG,CAAC,QAAQ,EAAE,GAAG,GAAG,CAAC;AACnE;AACA,MAAM,IAAI,KAAK,IAAI,IAAI,EAAE;AACzB,QAAQ,OAAO;AACf,OAAO;AACP,MAAM,MAAM,CAAC,IAAI,CAAC;AAClB,QAAQ,IAAI,EAAE,GAAG;AACjB,QAAQ,KAAK;AACb,QAAQ,aAAa,EAAE,OAAO,GAAG,KAAK,QAAQ;AAC9C,OAAO,CAAC,CAAC;AACT,KAAK,CAAC,CAAC;AACP;AACA,IAAI,MAAM,cAAc,GAAG,EAAE,CAAC;AAC9B,IAAI,IAAI,MAAM,CAAC,MAAM,EAAE;AACvB,MAAM,cAAc,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,YAAY,EAAE,SAAS,EAAE,MAAM,EAAE,CAAC,CAAC;AACvE,KAAK;AACL;AACA,IAAI,IAAI,cAAc,CAAC,MAAM,EAAE;AAC/B,MAAM,UAAU,CAAC,MAAM;AACvB,QAAQ,MAAM,CAAC,SAAS,EAAE,EAAE,cAAc,EAAE,CAAC,CAAC;AAC9C,OAAO,CAAC,CAAC;AACT,KAAK;AACL,GAAG,CAAC,CAAC;AACL,CAAC"}