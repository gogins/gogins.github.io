{"version":3,"file":"metadata_parser_97dd1954.mjs","sources":["../../../src/pages/metadata_parser.js"],"sourcesContent":["const ALLOW_MANY = ['by', 'url', 'genre', 'license'];\n\nexport function getMetadata(raw_code) {\n  const comment_regexp = /\\/\\*([\\s\\S]*?)\\*\\/|\\/\\/(.*)$/gm;\n  const comments = [...raw_code.matchAll(comment_regexp)].map((c) => (c[1] || c[2] || '').trim());\n  const tags = {};\n\n  const [prefix, title] = (comments[0] || '').split('\"');\n  if (prefix.trim() === '' && title !== undefined) {\n    tags['title'] = title;\n  }\n\n  for (const comment of comments) {\n    const tag_matches = comment.split('@').slice(1);\n    for (const tag_match of tag_matches) {\n      let [tag, tag_value] = tag_match.split(/ (.*)/s);\n      tag = tag.trim();\n      tag_value = (tag_value || '').replaceAll(/ +/g, ' ').trim();\n\n      if (ALLOW_MANY.includes(tag)) {\n        const tag_list = tag_value\n          .split(/[,\\n]/)\n          .map((t) => t.trim())\n          .filter((t) => t !== '');\n        tags[tag] = tag in tags ? tags[tag].concat(tag_list) : tag_list;\n      } else {\n        tag_value = tag_value.replaceAll(/\\s+/g, ' ');\n        tags[tag] = tag in tags ? tags[tag] + ' ' + tag_value : tag_value;\n      }\n    }\n  }\n\n  return tags;\n}\n"],"names":[],"mappings":"AAAA,MAAM,UAAU,GAAG,CAAC,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,SAAS,CAAC,CAAC;AACrD;AACO,SAAS,WAAW,CAAC,QAAQ,EAAE;AACtC,EAAE,MAAM,cAAc,GAAG,gCAAgC,CAAC;AAC1D,EAAE,MAAM,QAAQ,GAAG,CAAC,GAAG,QAAQ,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,CAAC,CAAC;AAClG,EAAE,MAAM,IAAI,GAAG,EAAE,CAAC;AAClB;AACA,EAAE,MAAM,CAAC,MAAM,EAAE,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,EAAE,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC;AACzD,EAAE,IAAI,MAAM,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,KAAK,KAAK,SAAS,EAAE;AACnD,IAAI,IAAI,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC;AAC1B,GAAG;AACH;AACA,EAAE,KAAK,MAAM,OAAO,IAAI,QAAQ,EAAE;AAClC,IAAI,MAAM,WAAW,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;AACpD,IAAI,KAAK,MAAM,SAAS,IAAI,WAAW,EAAE;AACzC,MAAM,IAAI,CAAC,GAAG,EAAE,SAAS,CAAC,GAAG,SAAS,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;AACvD,MAAM,GAAG,GAAG,GAAG,CAAC,IAAI,EAAE,CAAC;AACvB,MAAM,SAAS,GAAG,CAAC,SAAS,IAAI,EAAE,EAAE,UAAU,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC;AAClE;AACA,MAAM,IAAI,UAAU,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;AACpC,QAAQ,MAAM,QAAQ,GAAG,SAAS;AAClC,WAAW,KAAK,CAAC,OAAO,CAAC;AACzB,WAAW,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,CAAC;AAC/B,WAAW,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;AACnC,QAAQ,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,IAAI,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,QAAQ,CAAC;AACxE,OAAO,MAAM;AACb,QAAQ,SAAS,GAAG,SAAS,CAAC,UAAU,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;AACtD,QAAQ,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,IAAI,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,SAAS,GAAG,SAAS,CAAC;AAC1E,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA,EAAE,OAAO,IAAI,CAAC;AACd;;;;"}