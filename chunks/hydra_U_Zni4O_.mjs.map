{"version":3,"file":"hydra_U_Zni4O_.mjs","sources":["../../../packages/hydra/hydra.mjs"],"sourcesContent":["import { getDrawContext } from '@strudel/draw';\nimport { controls } from '@strudel/core';\n\nlet latestOptions;\nlet hydra;\n\nexport async function initHydra(options = {}) {\n  // reset if options have changed since last init\n  if (latestOptions && JSON.stringify(latestOptions) !== JSON.stringify(options)) {\n    document.getElementById('hydra-canvas')?.remove();\n  }\n  latestOptions = options;\n  //load and init hydra\n  if (!document.getElementById('hydra-canvas')) {\n    const {\n      src = 'https://unpkg.com/hydra-synth',\n      feedStrudel = false,\n      contextType = 'webgl',\n      pixelRatio = 1,\n      pixelated = true,\n      ...hydraConfig\n    } = {\n      detectAudio: false,\n      ...options,\n    };\n    const { canvas } = getDrawContext('hydra-canvas', { contextType, pixelRatio, pixelated });\n    hydraConfig.canvas = canvas;\n\n    await import(/* @vite-ignore */ src);\n    hydra = new Hydra(hydraConfig);\n    if (feedStrudel) {\n      const { canvas } = getDrawContext();\n      canvas.style.display = 'none';\n      hydra.synth.s0.init({ src: canvas });\n    }\n  }\n}\n\nexport function clearHydra() {\n  if (hydra) {\n    hydra.hush();\n  }\n  globalThis.s0?.clear();\n  document.getElementById('hydra-canvas')?.remove();\n  globalThis.speed = controls.speed;\n  globalThis.shape = controls.shape;\n}\n\nexport const H = (p) => () => p.queryArc(getTime(), getTime())[0].value;\n"],"names":["controls.speed","controls.shape"],"mappings":";;AAGA,IAAI,aAAa,CAAC;AAClB,IAAI,KAAK,CAAC;AACV;AACO,eAAe,SAAS,CAAC,OAAO,GAAG,EAAE,EAAE;AAC9C;AACA,EAAE,IAAI,aAAa,IAAI,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,KAAK,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE;AAClF,IAAI,QAAQ,CAAC,cAAc,CAAC,cAAc,CAAC,EAAE,MAAM,EAAE,CAAC;AACtD,GAAG;AACH,EAAE,aAAa,GAAG,OAAO,CAAC;AAC1B;AACA,EAAE,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,cAAc,CAAC,EAAE;AAChD,IAAI,MAAM;AACV,MAAM,GAAG,GAAG,+BAA+B;AAC3C,MAAM,WAAW,GAAG,KAAK;AACzB,MAAM,WAAW,GAAG,OAAO;AAC3B,MAAM,UAAU,GAAG,CAAC;AACpB,MAAM,SAAS,GAAG,IAAI;AACtB,MAAM,GAAG,WAAW;AACpB,KAAK,GAAG;AACR,MAAM,WAAW,EAAE,KAAK;AACxB,MAAM,GAAG,OAAO;AAChB,KAAK,CAAC;AACN,IAAI,MAAM,EAAE,MAAM,EAAE,GAAG,cAAc,CAAC,cAAc,EAAE,EAAE,WAAW,EAAE,UAAU,EAAE,SAAS,EAAE,CAAC,CAAC;AAC9F,IAAI,WAAW,CAAC,MAAM,GAAG,MAAM,CAAC;AAChC;AACA,IAAI,MAAM,0BAA0B,GAAG,CAAC,CAAC;AACzC,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC,WAAW,CAAC,CAAC;AACnC,IAAI,IAAI,WAAW,EAAE;AACrB,MAAM,MAAM,EAAE,MAAM,EAAE,GAAG,cAAc,EAAE,CAAC;AAC1C,MAAM,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;AACpC,MAAM,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,MAAM,EAAE,CAAC,CAAC;AAC3C,KAAK;AACL,GAAG;AACH,CAAC;AACD;AACO,SAAS,UAAU,GAAG;AAC7B,EAAE,IAAI,KAAK,EAAE;AACb,IAAI,KAAK,CAAC,IAAI,EAAE,CAAC;AACjB,GAAG;AACH,EAAE,UAAU,CAAC,EAAE,EAAE,KAAK,EAAE,CAAC;AACzB,EAAE,QAAQ,CAAC,cAAc,CAAC,cAAc,CAAC,EAAE,MAAM,EAAE,CAAC;AACpD,EAAE,UAAU,CAAC,KAAK,GAAGA,KAAc,CAAC;AACpC,EAAE,UAAU,CAAC,KAAK,GAAGC,KAAc,CAAC;AACpC,CAAC;AACD;AACY,MAAC,CAAC,GAAG,CAAC,CAAC,KAAK,MAAM,CAAC,CAAC,QAAQ,CAAC,OAAO,EAAE,EAAE,OAAO,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;;;;"}